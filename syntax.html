<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link type="text/css" rel="stylesheet" href="resources/sheet.css" >
<style type="text/css">.ritz .waffle a { color: inherit; }.ritz .waffle .s5{background-color:#ffffff;text-align:left;color:#000000;font-family:"docs-Roboto Mono",Arial;font-size:10pt;vertical-align:bottom;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:2px 3px 2px 3px;}.ritz .waffle .s12{background-color:#ffffff;text-align:left;color:#000000;font-family:"docs-Roboto Mono",Arial;font-size:10pt;vertical-align:bottom;white-space:nowrap;direction:ltr;padding:2px 3px 2px 3px;}.ritz .waffle .s13{border-bottom:1px SOLID #000000;background-color:#ffffff;text-align:left;color:#000000;font-family:"docs-Roboto Mono",Arial;font-size:10pt;vertical-align:bottom;white-space:nowrap;direction:ltr;padding:2px 3px 2px 3px;}.ritz .waffle .s8{border-left:none;border-right:none;background-color:#ffffff;text-align:left;color:#000000;font-family:"docs-Roboto Mono",Arial;font-size:10pt;vertical-align:bottom;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:2px 3px 2px 3px;}.ritz .waffle .s7{border-right:none;background-color:#ffffff;text-align:left;color:#000000;font-family:"docs-Roboto Mono",Arial;font-size:10pt;vertical-align:bottom;white-space:nowrap;direction:ltr;padding:2px 3px 2px 3px;}.ritz .waffle .s9{border-left:none;background-color:#ffffff;text-align:left;color:#000000;font-family:"docs-Roboto Mono",Arial;font-size:10pt;vertical-align:bottom;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:2px 3px 2px 3px;}.ritz .waffle .s3{border-bottom:1px SOLID #000000;border-right:1px SOLID #000000;background-color:#000000;text-align:left;color:#000000;font-family:"docs-Roboto Mono",Arial;font-size:10pt;vertical-align:bottom;white-space:nowrap;direction:ltr;padding:2px 3px 2px 3px;}.ritz .waffle .s11{background-color:#f3f3f3;text-align:left;color:#666666;font-family:"docs-Roboto Mono",Arial;font-size:10pt;vertical-align:bottom;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:2px 3px 2px 3px;}.ritz .waffle .s1{border-left:none;border-bottom:1px SOLID #000000;background-color:#000000;text-align:left;color:#ffffff;font-family:"docs-Roboto Mono",Arial;font-size:10pt;vertical-align:bottom;white-space:nowrap;direction:ltr;padding:2px 3px 2px 3px;}.ritz .waffle .s6{border-bottom:1px SOLID #000000;background-color:#ffffff;text-align:left;color:#000000;font-family:"docs-Roboto Mono",Arial;font-size:10pt;vertical-align:bottom;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:2px 3px 2px 3px;}.ritz .waffle .s0{border-right:none;border-bottom:1px SOLID #000000;background-color:#000000;text-align:left;color:#ffffff;font-family:"docs-Roboto Mono",Arial;font-size:10pt;vertical-align:bottom;white-space:nowrap;direction:ltr;padding:2px 3px 2px 3px;}.ritz .waffle .s2{border-bottom:1px SOLID #000000;border-right:1px SOLID #000000;background-color:#000000;text-align:left;color:#ffffff;font-family:"docs-Roboto Mono",Arial;font-size:10pt;vertical-align:bottom;white-space:nowrap;direction:ltr;padding:2px 3px 2px 3px;}.ritz .waffle .s10{border-left:none;border-right:none;border-bottom:1px SOLID #000000;background-color:#000000;text-align:left;color:#ffffff;font-family:"docs-Roboto Mono",Arial;font-size:10pt;vertical-align:bottom;white-space:nowrap;direction:ltr;padding:2px 3px 2px 3px;}.ritz .waffle .s4{border-bottom:1px SOLID #000000;border-right:1px SOLID #efefef;background-color:#efefef;text-align:left;font-style:italic;color:#000000;font-family:"docs-Roboto Mono",Arial;font-size:10pt;vertical-align:bottom;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:2px 3px 2px 3px;}</style><div class="ritz grid-container" dir="ltr"><table class="waffle" cellspacing="0" cellpadding="0"><thead><tr><th class="row-header freezebar-origin-ltr"></th><th id="0C0" style="width:202px;" class="column-headers-background">A</th><th id="0C1" style="width:309px;" class="column-headers-background">B</th><th id="0C2" style="width:318px;" class="column-headers-background">C</th><th id="0C3" style="width:390px;" class="column-headers-background">D</th><th id="0C4" style="width:385px;" class="column-headers-background">E</th><th id="0C5" style="width:233px;" class="column-headers-background">F</th></tr></thead><tbody><tr style="height: 20px"><th id="0R0" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">1</div></th><td class="s0 softmerge" dir="ltr"><div class="softmerge-inner" style="width:509px;left:-1px">Logical Operators (examples from Slides)</div></td><td class="s1"></td><td class="s1"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R1" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">2</div></th><td class="s4">Operator</td><td class="s4">Definition</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4"></td><td class="s4"></td></tr><tr style="height: 20px"><th id="0R2" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">3</div></th><td class="s5">AND</td><td class="s5">The AND operator allows the existence of multiple conditions in an SQL statement&#39;s WHERE clause.</td><td class="s5">SELECT col1<br> FROM table<br> WHERE col1=VALUE AND col2=VALUE</td><td class="s5">SELECT * <br> FROM Contact<br> WHERE LastName = &#39;Adams&#39; AND FirstName = &#39;Mary&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R3" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">4</div></th><td class="s5">OR</td><td class="s5">The OR operator is used to combine multiple conditions in an SQL statement&#39;s WHERE clause.</td><td class="s5">SELECT col1<br> FROM table<br> WHERE col1=VALUE OR col2=VALUE</td><td class="s5">SELECT * <br> FROM Contact<br> WHERE LastName = &#39;Adams&#39; OR FirstName = &#39;Mary&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R4" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">5</div></th><td class="s5">AND and OR with Parentheses</td><td class="s5" dir="ltr">Example of using both AND and OR in a WHERE clause, with parentheses</td><td class="s5">--</td><td class="s5">SELECT * <br> FROM Contact<br> WHERE LastName = &#39;Adams&#39; AND (FirstName=&#39;Carla&#39; OR FirstName=&#39;Mary&#39;)</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R5" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">6</div></th><td class="s5">BETWEEN</td><td class="s5">The BETWEEN operator selects a range of data between two values (a minimum and maximum). The values can be numbers, text, or dates.</td><td class="s5">SELECT colname <br> FROM table<br> WHERE colname BETWEEN value1 AND value2</td><td class="s5">SELECT * <br> FROM BillOfMaterials<br> WHERE PerAssemblyQty BETWEEN 2 AND 4</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R6" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">7</div></th><td class="s5">IN</td><td class="s5">The IN operator is used to compare a value to a list of literal values that have been specified.</td><td class="s5">SELECT colname<br> FROM table<br> WHERE colname IN (value1, value2)</td><td class="s5">SELECT *<br> FROM Contact<br> WHERE LastName IN (&#39;Abel&#39;,&#39;Smith&#39;)</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R7" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">8</div></th><td class="s5">NOT</td><td class="s5">The NOT operator reverses the meaning of the logical operator with which it is used. Eg: NOT EXISTS, NOT BETWEEN, NOT IN, etc. This is a negate operator.</td><td class="s5">SELECT colname<br> FROM table<br> WHERE colname NOT IN (value1, value2)</td><td class="s5">SELECT ProductID, VendorID, StandardPrice<br> FROM ProductVendor<br> WHERE ProductID NOT IN (317, 318)*</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R8" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">9</div></th><td class="s5">IS NULL</td><td class="s5">The NULL operator is used to compare a value with a NULL value.</td><td class="s5">--</td><td class="s5" dir="ltr">SELECT *<br>FROM table<br>WHERE column IS NULL;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R9" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">10</div></th><td class="s5">LIKE</td><td class="s5">LIKE (is technically not an operator, but a predicate) is used to compare a value to similar values using wildcard operators (i.e., LIKE is used to search for a specified pattern in a column).</td><td class="s5">SELECT colname<br> FROM table<br> WHERE colname LIKE pattern</td><td class="s5">examples</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R10" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">11</div></th><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R11" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">12</div></th><td class="s2" dir="ltr">Wildcard Operators</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R12" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">13</div></th><td class="s4">Operator</td><td class="s4">Definition</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4"></td><td class="s4"></td></tr><tr style="height: 20px"><th id="0R13" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">14</div></th><td class="s5">% Percent sign</td><td class="s5">Matches one or more characters</td><td class="s5">see below</td><td class="s5"></td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R14" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">15</div></th><td class="s5" dir="ltr">  LIKE &#39;J%&#39;</td><td class="s5">String begins with &#39;J&#39;</td><td class="s5">SELECT * <br> FROM Contact<br> WHERE LastName LIKE &#39;J%&#39;</td><td class="s5">SELECT *<br> FROM Product<br> WHERE Name LIKE &#39;ML Touring%&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R15" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">16</div></th><td class="s5" dir="ltr">  LIKE &#39;%J&#39;</td><td class="s5">String ends with &#39;J&#39;</td><td class="s5">SELECT * <br> FROM Contact<br> WHERE LastName LIKE &#39;%J&#39;</td><td class="s5">SELECT *<br> FROM Product<br> WHERE Name LIKE &#39;%Crankarm&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R16" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">17</div></th><td class="s5" dir="ltr">  LIKE &#39;mail.%.com&#39;</td><td class="s5">String begins with &#39;mail.&#39; and ends with &#39;.com&#39; (the search phrase is in between these pre-defined strings)</td><td class="s5">--</td><td class="s5">SELECT *<br> FROM Product<br> WHERE Name LIKE &#39;Men%,L&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R17" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">18</div></th><td class="s5" dir="ltr">  LIKE &#39;%J%&#39;</td><td class="s5">String contains &#39;J&#39;</td><td class="s5">SELECT * <br> FROM Contact<br> WHERE LastName LIKE &#39;%J%&#39;</td><td class="s5">SELECT *<br> FROM Product<br> WHERE Name LIKE &#39;%Disc 1%&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R18" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">19</div></th><td class="s5" dir="ltr">  NOT LIKE &#39;%J%&#39;</td><td class="s5">String does not contain &#39;J&#39;</td><td class="s5">SELECT * <br> FROM Contact<br> WHERE LastName NOT LIKE &#39;%J%‘</td><td class="s5">SELECT ProductID, Name, ListPrice<br> FROM Product<br> WHERE Name LIKE &#39;%Nut%&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R19" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">20</div></th><td class="s5">_ Underscore</td><td class="s5">Matches exactly one character. Functions like the % wildcard.</td><td class="s5">--</td><td class="s5">SELECT * <br> FROM Contact<br> WHERE LastName LIKE &#39;A_ams&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R20" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">21</div></th><td class="s5">[charlist]*</td><td class="s5">Matches any single character in charlist [abcdef] or [a-f], not in a specific order (i.e., the search pattern is for a set or range of characters)</td><td class="s5">--</td><td class="s5">SELECT * <br> FROM Contact<br> WHERE EmailPromotion LIKE &#39;[0]%&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R21" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">22</div></th><td class="s5" dir="ltr">  LIKE &#39;[HL]%&#39;</td><td class="s5">Name begins with either H or L</td><td class="s5">--</td><td class="s5">SELECT *<br> FROM Product<br> WHERE Name LIKE &#39;[HL]%&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R22" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">23</div></th><td class="s5">[^charlist] or<br> [!charlist]</td><td class="s5">Matches only a character NOT in brackets ([^a-f]) or set ([^abcdef])</td><td class="s5"></td><td class="s5"></td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R23" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">24</div></th><td class="s7 softmerge"><div class="softmerge-inner" style="width:1602px;left:-1px">*Note: DB Browser might use another format for this operator; with the same data and query, this query won&#39;t execute and return the same rows (it returns none compared to the exercise)</div></td><td class="s8"></td><td class="s8"></td><td class="s8"></td><td class="s9"></td><td class="s9"></td></tr><tr style="height: 20px"><th id="0R24" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">25</div></th><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R25" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">26</div></th><td class="s2" dir="ltr">Arithmetic Operators</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R26" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">27</div></th><td class="s4">Operator</td><td class="s4">Definition</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4"></td><td class="s4"></td></tr><tr style="height: 20px"><th id="0R27" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">28</div></th><td class="s5">=+ (addition)</td><td class="s5">Adds values on either side of the operator</td><td class="s5">SELECT (col1 + col2) AS alias</td><td class="s5">SELECT (SubTotal+Freight) AS TotalDue<br> FROM SalesOrderHeader;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R28" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">29</div></th><td class="s5">- (subtraction)</td><td class="s5">Subtracts right hand operand from left hand operand</td><td class="s5">SELECT (col1 - col2) AS alias</td><td class="s5">SELECT *<br> FROM SalesOrderHeader<br> WHERE (TotalDue-TaxAmt-Freight) = Subtotal;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R29" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">30</div></th><td class="s5">* (multiplication)</td><td class="s5">Multiplies values on either side of the operator</td><td class="s5">SELECT<br> col1*col2 AS alias</td><td class="s5">SELECT (UnitPrice*OrderQty) AS TotalCost<br> FROM <br> PurchaseOrderDetail;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R30" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">31</div></th><td class="s5">/ (division)</td><td class="s5">Divides left hand operand by right hand operand</td><td class="s5">SELECT col1 / col2 AS alias</td><td class="s5">SELECT UnitPrice,(UnitPrice*5/100) AS Commission<br> FROM PurchaseOrderDetail;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R31" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">32</div></th><td class="s7 softmerge"><div class="softmerge-inner" style="width:1217px;left:-1px">*note: we haven&#39;t learned WHERE statements with operators yet, so this is a somewhat new topic to be explored later in the book</div></td><td class="s8"></td><td class="s8"></td><td class="s9"></td><td class="s9"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R32" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">33</div></th><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R33" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">34</div></th><td class="s0 softmerge" dir="ltr"><div class="softmerge-inner" style="width:827px;left:-1px">System Functions (&#39;Commonly Used Text Manipulation Functions&#39;, pg. 74)</div></td><td class="s10"></td><td class="s1"></td><td class="s1"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R34" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">35</div></th><td class="s4">Function()</td><td class="s4">Definition</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4"></td><td class="s4"></td></tr><tr style="height: 20px"><th id="0R35" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">36</div></th><td class="s5">LEFT()</td><td class="s5">Returns the leftmost number of characters as specified</td><td class="s5">SELECT colname, <br> LEFT(colname, # of characters)</td><td class="s5">SELECT Left(LastName,3) As LeftThree<br> FROM Contact;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R36" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">37</div></th><td class="s5">RIGHT()</td><td class="s5">Returns the specified rightmost number of characters</td><td class="s5">SELECT colname, <br> RIGHT(colname, # of characters)</td><td class="s5">SELECT Right(LastName,3) As RightThree<br> FROM Contact;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R37" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">38</div></th><td class="s5"><a target="_blank" href="http://function_rtrim/">RTRIM()</a>*</td><td class="s5">Removes trailing spaces (i.e., whitespaces from the right)</td><td class="s5">SELECT RTRIM(colname)</td><td class="s5">SELECT  <br>  RTRIM(FirstName)+&#39; &#39;+ RTRIM(LastName) AS Name<br> FROM <br>  Contact</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R38" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">39</div></th><td class="s5"><a target="_blank" href="http://function_ltrim/">LTRIM()</a>*</td><td class="s5">Removes leading spaces (i.e., whitespaces from the left)</td><td class="s5">SELECT LTRIM(colname)</td><td class="s5">SELECT  <br>  LTRIM(FirstName)+&#39; &#39;+ LTRIM(LastName) AS Name<br> FROM <br>  Contact</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R39" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">40</div></th><td class="s5" dir="ltr">  example (variation)</td><td class="s5">LTRIM and RTRIM</td><td class="s5">--</td><td class="s5">SELECT  <br>  LTRIM(RTRIM(FirstName))+&#39; &#39;+ LTRIM(RTRIM(LastName)) AS Name<br> FROM <br>  Contact</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R40" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">41</div></th><td class="s5">UPPER()</td><td class="s5">Returns the argument in uppercase</td><td class="s5">SELECT UPPER(colname)</td><td class="s5">SELECT Name, UPPER(Name) As UpperCaseName<br> FROM Product;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R41" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">42</div></th><td class="s5">LOWER()</td><td class="s5">Returns the argument in lowercase</td><td class="s5">SELECT LOWER(colname)</td><td class="s5">SELECT Name, LOWER(Name) As LowerCaseName<br> FROM Product</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R42" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">43</div></th><td class="s5">LENGTH()</td><td class="s5">Returns the length of a string in bytes</td><td class="s5">WHERE LENGTH(colname) = integer</td><td class="s5">--</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R43" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">44</div></th><td class="s5">SOUNDEX()</td><td class="s5">Returns a soundex string</td><td class="s5">WHERE SOUNDEX(colname) = SOUNDEX(&#39;rowvalue&#39;)</td><td class="s5">SELECT cust_name, cust_contact<br> FROM Customers<br> WHERE SOUNDEX(cust_contact) = SOUNDEX(&#39;Michael Green&#39;);</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R44" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">45</div></th><td class="s7 softmerge"><div class="softmerge-inner" style="width:509px;left:-1px">*Note: SQL Server does not support TRIM() function</div></td><td class="s9"></td><td class="s9"></td><td class="s5"></td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R45" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">46</div></th><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R46" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">47</div></th><td class="s2" dir="ltr">Date and Time Functions</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R47" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">48</div></th><td class="s4">Function()</td><td class="s4">Definition</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4"></td><td class="s4"></td></tr><tr style="height: 20px"><th id="0R48" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">49</div></th><td class="s5">GETDATE()</td><td class="s5">Returns the current date and time</td><td class="s5" dir="ltr">GETDATE()</td><td class="s5">SELECT *<br> FROM Contact<br> WHERE DATEPART(mm,ModifiedDate) = DATEPART(mm,GETDATE());</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R49" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">50</div></th><td class="s5" dir="ltr">date(&#39;now&#39;)</td><td class="s5" dir="ltr">SQLite function to return the current date and time; equivalent to GETDATE()</td><td class="s5" dir="ltr">date(&#39;now&#39;)</td><td class="s5" dir="ltr">SELECT *<br>FROM Orders<br>WHERE order_date &gt;= date(&#39;now&#39;, &#39;start of year&#39;) AND order_date &lt;  date(&#39;now&#39;, &#39;start of year&#39;, &#39;+1 year&#39;);</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R50" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">51</div></th><td class="s5">DATEPART()</td><td class="s5">Returns a single part of a date/time (notice that these examples are all WHERE statements vs. SELECT statements; please see DATENAME() for SELECT statements and date formatting)</td><td class="s5">WHERE DatePart(yyyy,ModifiedDate) =&gt;&lt; year</td><td class="s5">SELECT *<br> FROM Contact<br> WHERE DATEPART(yyyy,ModifiedDate) = 2005</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R51" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">52</div></th><td class="s5" dir="ltr">  mm</td><td class="s5">returns dates occurring in January across all dates in the ModifiedDate column</td><td class="s5">WHERE DATEPART(mm,ModifiedDate) =&gt;&lt; month</td><td class="s5">SELECT *<br> FROM Contact<br> WHERE DATEPART(mm,ModifiedDate) &lt; 2</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R52" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">53</div></th><td class="s5" dir="ltr">  dd</td><td class="s5">returns dates on the 1st of each month across all dates in the ModifiedDate column</td><td class="s5">WHERE DATEPART(dd,ModifiedDate) &lt; day of month</td><td class="s5">SELECT *<br> FROM Contact<br> WHERE DATEPART(dd,ModifiedDate) &lt; 2</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R53" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">54</div></th><td class="s5" dir="ltr">DATEADD()</td><td class="s5">Adds or subtracts a specified time interval from a date and returns a date</td><td class="s5">SELECT DATEADD(Day,21,column_name) AS Alias</td><td class="s5">SELECT DueDate<br> FROM PurchaseOrderDetail</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R54" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">55</div></th><td class="s5" dir="ltr">  example</td><td class="s5">the SELECT statement syntax used to add 21 days to the DueDate column</td><td class="s5">--</td><td class="s5">SELECT ProductID, DueDate,DATEADD(Day,21,DueDate) AS NewDueDate<br> FROM PurchaseOrderDetail</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R55" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">56</div></th><td class="s5">DATEDIFF()</td><td class="s5">Returns the time between two dates as number of days/hours/months/years/weeks etc.</td><td class="s5">SELECT DATEDIFF(Day,DateColumnName,GETDATE()) AS NumberOfDays</td><td class="s5">SELECT FirstName, LastName, ModifiedDate, DATEDIFF(day,ModifiedDate, GetDate()) AS numberOfDays<br> FROM Contact</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R56" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">57</div></th><td class="s5" dir="ltr">  example 1</td><td class="s5">Count the difference in the number of days from the due date to the current date</td><td class="s5">SELECT DATEDIFF(Day,DueDate,GETDATE()) AS NumberOfDays</td><td class="s5">SELECT <br>  DueDate,DATEDIFF(Day,DueDate,GETDATE()) AS numberOfDays<br> FROM <br>  PurchaseOrderDetail</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R57" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">58</div></th><td class="s5" dir="ltr">  example 2</td><td class="s5">Return number of days between current date and when employee was hired</td><td class="s5">SELECT DATEDIFF(Day,HireDate,GETDATE()) AS NumberOfdays</td><td class="s5">SELECT HireDate, GETDATE() as TodaysDate, DATEDIFF(Day,HireDate,GETDATE()) AS NumberOfDays<br> FROM Employee</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R58" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">59</div></th><td class="s5" dir="ltr">  example: hour</td><td class="s5">Return number of hours between two points in time using the DATEDIFF() function</td><td class="s5">SELECT DATEDIFF(hour,DateColumnName,GETDATE()) AS NumberOfHours</td><td class="s5">SELECT FirstName, LastName, ModifiedDate, DATEDIFF(hour,ModifiedDate, GetDate()) AS NumberOfHours</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R59" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">60</div></th><td class="s5"><a target="_blank" href="http://www.w3schools.com/sql/func_convert.asp">CONVERT()</a>*</td><td class="s5">Displays date/time data in different formats; converts one data type to another data type (in general)</td><td class="s5">SELECT CONVERT(Char(12), GetDate(), 101) as TodaysDate</td><td class="s5">SELECT CONVERT(Char(12), HireDate, 101) as HireDate, CONVERT(Char(12), GetDate(), 101) as TodaysDate, DATEDIFF(Day,HireDate,GETDATE()) AS NumberOfdays<br> FROM Employee</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R60" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">61</div></th><td class="s5">DATENAME()</td><td class="s5">returns the month (&#39;month&#39;) from the specified date</td><td class="s5">SELECT DATENAME(month,GetDate()) AS &#39;Month Name&#39;</td><td class="s5">SELECT <br>  CONVERT(Char(12),DueDate, 101) AS DueDate,<br>  DATENAME(month,DueDate) AS &#39;Month Name&#39; <br> FROM <br>  PurchaseOrderDetail</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R61" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">62</div></th><td class="s5" dir="ltr">  m for month</td><td class="s5">returns the month (&#39;m&#39;) from the specified date</td><td class="s5">DATENAME(m,GetDate())</td><td class="s5">SELECT <br>  CONVERT(Char(12),DueDate, 101) AS DueDate,<br>  DATENAME(m,DueDate) AS &#39;Month Name&#39; <br> FROM <br>  PurchaseOrderDetail</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R62" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">63</div></th><td class="s5" dir="ltr">  dw for weekday</td><td class="s5">returns the weekday (&#39;dw&#39;) from the specified date</td><td class="s5">DATENAME(dw,GetDate())</td><td class="s5">SELECT <br>  CONVERT(Char(12),DueDate, 101) AS DueDate,<br>  DATENAME(dw,DueDate) AS &#39;Day of the Week&#39; <br> FROM <br>  PurchaseOrderDetail</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R63" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">64</div></th><td class="s5" dir="ltr">  yy for year</td><td class="s5">returns the year (&#39;yy&#39;) from the specified date</td><td class="s5">DATENAME(yy,GetDate())</td><td class="s5">SELECT <br>  CONVERT(Char(12),DueDate, 101) AS DueDate,<br>  DATENAME(yy,DueDate) AS &#39;Year&#39; <br> FROM <br>  PurchaseOrderDetail</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R64" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">65</div></th><td class="s5" dir="ltr">DATEFROMPARTS()</td><td class="s5" dir="ltr">returns the date part from a date column; used with the UPDATE statement to change a date in a column&#39;s month, date and/or year</td><td class="s5" dir="ltr">DATEFROMPARTS(YEAR(column_name), MONTH(column_name), DAY(column_name))</td><td class="s5" dir="ltr">--</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R65" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">66</div></th><td class="s5" dir="ltr">  month</td><td class="s5" dir="ltr">change the month in a date column (see example &gt;&gt;) to a specified month</td><td class="s5" dir="ltr">DATEFROMPARTS(YEAR(column_name), 10, DAY(column_name))</td><td class="s5" dir="ltr">UPDATE dbo.Employee<br>SET BirthDate = DATEFROMPARTS(YEAR(BirthDate), 10, DAY(BirthDate))<br>WHERE EmployeeID = 224;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R66" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">67</div></th><td class="s7 softmerge"><div class="softmerge-inner" style="width:1217px;left:-1px">*Syntax for CONVERT() function needs verification (i.e., what is the 101 for? is that standard or is that a user-designated value)</div></td><td class="s8"></td><td class="s8"></td><td class="s9"></td><td class="s9"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R67" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">68</div></th><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R68" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">69</div></th><td class="s2" dir="ltr">String Functions</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R69" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">70</div></th><td class="s4">Function</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4"></td><td class="s4"></td></tr><tr style="height: 20px"><th id="0R70" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">71</div></th><td class="s5">Concatenation</td><td class="s5">concatenating without CONCAT()</td><td class="s5">SELECT Col1 + &#39; &#39; + Col2 AS alias</td><td class="s5">SELECT Name+&#39;(&#39;+ AccountNumber+&#39;)&#39;<br> FROM Vendor</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R71" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">72</div></th><td class="s5">CONCAT()</td><td class="s5">basic CONCAT() usage</td><td class="s5">SELECT CONCAT(Col2, &#39; &#39;, Col3, &#39; &#39;, Col4) AS alias</td><td class="s5">SELECT CONCAT(FirstName, &#39; &#39;, LastName)<br> FROM Customer;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R72" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">73</div></th><td class="s5" dir="ltr">  multiple columns</td><td class="s5">at least two variables in the SELECT statement</td><td class="s5">SELECT Col1, Concat(Col2, &#39; &#39;, Col3, &#39; &#39;, Col4) AS alias</td><td class="s5">SELECT CustomerID, CONCAT(FirstName, &#39; &#39;, LastName)<br> FROM Customer;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R73" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">74</div></th><td class="s5" dir="ltr">Alias</td><td class="s5" dir="ltr">An alternate name for a field or a value, assigned by the AS keyword</td><td class="s5" dir="ltr">SELECT colname AS alias</td><td class="s5" dir="ltr">SELECT Quantity*Price AS &#39;Subtotal&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R74" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">75</div></th><td class="s5" dir="ltr">  for a column</td><td class="s5">To combine two columns in a SELECT statement and give it a new aliases Name we use the “AS” keyword</td><td class="s5">SELECT colname+‘(‘ + colname+‘)’ AS alias <br> FROM table</td><td class="s5">SELECT Name+&#39;(&#39;+AccountNumber+&#39;)&#39; AS VendorNameNumber<br> FROM Vendor</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R75" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">76</div></th><td class="s5" dir="ltr">  for a table</td><td class="s5" dir="ltr">&quot;&quot;</td><td class="s5">SELECT colname<br> FROM tablename AS alias</td><td class="s5" dir="ltr">&quot;&quot;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R76" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">77</div></th><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R77" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">78</div></th><td class="s2" dir="ltr">Aggregate Function</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R78" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">79</div></th><td class="s4">Function</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Null Values</td><td class="s4"></td></tr><tr style="height: 20px"><th id="0R79" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">80</div></th><td class="s5" dir="ltr">AVG()</td><td class="s5" dir="ltr">returns a column&#39;s average value</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT avg(prod_price) as avg_price</td><td class="s5" dir="ltr">ignores null values</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R80" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">81</div></th><td class="s5" dir="ltr">COUNT(*)</td><td class="s5" dir="ltr">returns the number of rows in a column</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT COUNT(*) as &#39;numberOfCustomers&#39; FROM Customers</td><td class="s5" dir="ltr">counts null values with COUNT(*)</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R81" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">82</div></th><td class="s5" dir="ltr">COUNT(column_name)</td><td class="s5" dir="ltr">returns the number of rows in a column</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT COUNT(cust_email) as &#39;emailCount&#39; FROM Customers</td><td class="s5" dir="ltr">ignores null values with COUNT(column_name)</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R82" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">83</div></th><td class="s5" dir="ltr">MAX()</td><td class="s5" dir="ltr">returns a column&#39;s highest value</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT MAX(prod_price) as &#39;HighestProdPrice&#39; FROM Products</td><td class="s5" dir="ltr">ignores null values</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R83" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">84</div></th><td class="s5" dir="ltr">MIN()</td><td class="s5" dir="ltr">returns a column&#39;s lowest value</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT MIN(prod_price) as &#39;LowestProdPrice&#39; FROM Products</td><td class="s5" dir="ltr">ignores null values</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R84" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">85</div></th><td class="s5" dir="ltr">SUM(column_name)</td><td class="s5" dir="ltr">returns the sum of a set of a column&#39;s values</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT SUM(quantity) as &#39;items_ordered&#39; FROM OrderItems WHERE order_num = 20005</td><td class="s5" dir="ltr">ignores null values</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R85" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">86</div></th><td class="s5" dir="ltr">SUM(col1*+-/col2)</td><td class="s5" dir="ltr">returns the sum of a set of a calculated value (such as an alias column)</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT SUM(item_price*quantity) AS &#39;total_price&#39; FROM OrderItems WHERE order_num = 20005</td><td class="s5" dir="ltr">ignores null values</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R86" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">87</div></th><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R87" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">88</div></th><td class="s2" dir="ltr">The GROUP BY Clause</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R88" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">89</div></th><td class="s4" dir="ltr">Objective</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Notes</td><td class="s4" dir="ltr">Prompts</td></tr><tr style="height: 20px"><th id="0R89" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">90</div></th><td class="s5" dir="ltr">GROUP BY basic usage</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">SELECT <br>  <span style="color:#ff00ff;">col1name</span>,<br>  COUNT(*) AS NewColName <br>FROM tablename<br>GROUP BY <span style="color:#ff00ff;">col1name</span></td><td class="s5" dir="ltr">SELECT <br>  <span style="color:#ff00ff;">VendorID</span>, <br>  Count(*) AS TotalNumberProducts <br>From ProductVendor<br>GROUP BY <span style="color:#ff00ff;">VendorID</span></td><td class="s5" dir="ltr">Can designate many columns</td><td class="s5" dir="ltr">Can you help me get report for the number of products carried by each of our vendors?</td></tr><tr style="height: 20px"><th id="0R90" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">91</div></th><td class="s5" dir="ltr">+ HAVING clause with an operator</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">SELECT <br>  <span style="color:#ff00ff;">col1name</span>, <br>  COUNT(*) AS NewColName <br>FROM tablename<br>GROUP BY <span style="color:#ff00ff;">col1name</span><br>HAVING COUNT(*) =&gt;&lt;!= <span style="color:#0000ff;">[value]</span></td><td class="s5" dir="ltr">Select<br>  <span style="color:#ff00ff;">EmployeeID</span>,<br>  SUM(VacationHours)<br>FROM Employee <br>GROUP BY <span style="color:#ff00ff;">EmployeeID<br></span>HAVING SUM(VacationHours) &gt; 20</td><td class="s5" dir="ltr"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R91" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">92</div></th><td class="s5" dir="ltr">+ HAVING clause with COUNT(*)</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">SELECT <br>  <span style="color:#ff00ff;">VendorID</span>, <br>  Count(*) AS TotalProducts <br>FROM ProductVendor<br>GROUP BY <span style="color:#ff00ff;">VendorID</span><br>HAVING COUNT(*) &gt;= 10</td><td class="s5" dir="ltr">[SMSS] the HAVING clause does not allow substituting COUNT(*) with an alias (e.g., HAVING TotalProducts &gt;= 10 will return an error)</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R92" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">93</div></th><td class="s5" dir="ltr">+ HAVING clause and WHERE clause</td><td class="s5" dir="ltr">the HAVING clause filters out entire groups (as opposed to the WHERE clause which filters out rows)</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">SELECT <br>  VendorID, <br>  COUNT(*) AS TotalProducts <br>FROM ProductVendor<br>WHERE StandardPrice &lt;=50<br>GROUP BY VendorID<br>HAVING COUNT(*) &gt;=10</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">Can you help me get a Vendor report for the vendors that have 10 or more products. Oh and the products should be $50 or less in price.</td></tr><tr style="height: 20px"><th id="0R93" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">94</div></th><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">An example of an operation that allows you to return calculated data in groups but filtering for specific group totals</td><td class="s5" dir="ltr">SELECT <br>  columnname, <br>  COUNT(*) AS NewColumnName <br>FROM tablename<br>GROUP BY columnName<br>HAVING Count(*) operator value<br>ORDER BY columnName</td><td class="s5" dir="ltr">SELECT <br>  SalesOrderID, <br>  SUM(OrderQty*UnitPrice) AS TotalCostQuantity <br>FROM SalesOrderDetail<br>GROUP BY SalesOrderID<br>HAVING SUM(OrderQty*UnitPrice)&gt;=1000</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">Can you help me get a Sales order where the total cost of the order is $1000 or above? I’d like the report show show the Sales Order ID, and the total cost of the order.</td></tr><tr style="height: 20px"><th id="0R94" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">95</div></th><td class="s5" dir="ltr">+ HAVING clause and a SELECT clause function</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">SELECT <br>  <span style="color:#ff00ff;">SalesOrderID</span>, <br>  CAST(SUM(OrderQty*UnitPrice) AS decimal(10,2)) AS TotalCostQuantity <br>FROM SalesOrderDetail<br>GROUP BY <span style="color:#ff00ff;">SalesOrderID</span><br>HAVING SUM(OrderQty*UnitPrice)&gt;=1000</td><td class="s5" dir="ltr">Changing the data type to decimal with two decimals to the right using the cast function</td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R95" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">96</div></th><td class="s5" dir="ltr">+ HAVING clause, a SELECT clause function, and an ORDER BY clause</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">SELECT <br>  <span style="color:#ff00ff;">SalesOrderID</span>, <br>  Cast(SUM(OrderQty*UnitPrice) AS decimal(10,2)) AS TotalCostQuantity <br>FROM SalesOrderDetail<br>GROUP BY <span style="color:#ff00ff;">SalesOrderID</span><br>HAVING SUM(OrderQty*UnitPrice)&gt;=2000<br>ORDER BY SalesOrderID, TotalCostQuantity</td><td class="s5" dir="ltr">Generates the same results as the above SQL query*</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R96" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">97</div></th><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R97" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">98</div></th><td class="s2" dir="ltr">Subqueries</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R98" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">99</div></th><td class="s4" dir="ltr">Objective</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Notes</td><td class="s4" dir="ltr">Prompts</td></tr><tr style="height: 20px"><th id="0R99" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">100</div></th><td class="s5" dir="ltr">Subquery in the WHERE clause</td><td class="s5" dir="ltr">A method to filter results</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">SELECT CustomerID<br>FROM SalesOrderHeader<br>WHERE <span style="color:#ff00ff;">SalesOrderID</span> IN (SELECT <span style="color:#ff00ff;">SalesOrderID</span><br>                       FROM SalesOrderDetail<br>                       WHERE ProductID=897);</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R100" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">101</div></th><td class="s5" dir="ltr">  outer query</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">SELECT column1 <br>FROM table<br>WHERE <span style="color:#ff00ff;">column2</span> IN (<span style="color:#ff6d01;">the subquery itself</span> or <span style="color:#9900ff;">the results derived from subquery</span>)</td><td class="s5" dir="ltr">SELECT CustomerID<br>FROM SalesOrderHeader<br>WHERE <span style="color:#ff00ff;">SalesOrderID</span> IN (<span style="color:#9900ff;">51823,51875</span>)</td><td class="s5" dir="ltr">SalesOrderID in the WHERE clause is to match the column name selected in the subquery</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R101" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">102</div></th><td class="s5" dir="ltr">  subquery</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">(<span style="color:#ff6d01;">SELECT</span> <span style="color:#ff00ff;">column2</span> <br> <span style="color:#ff6d01;">FROM table<br> WHERE column3 = &#39;VALUE&#39;</span>)</td><td class="s5" dir="ltr">(<span style="color:#ff6d01;">SELECT</span> <span style="color:#ff00ff;">SalesOrderID</span><br> <span style="color:#ff6d01;">FROM SalesOrderDetail<br> WHERE ProductID = 897</span>)</td><td class="s5" dir="ltr"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R102" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">103</div></th><td class="s5" dir="ltr">Two subqueries in the WHERE clause</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">&quot;&quot;</td><td class="s5" dir="ltr">SELECT (FirstName +&#39; &#39;+ LastName) AS CustomerName FROM Contact WHERE ContactID IN (SELECT ContactID FROM SalesOrderHeader WHERE SalesOrderID IN (SELECT SalesOrderID FROM SalesOrderDetail WHERE ProductID=897));</td><td class="s5" dir="ltr">Note the parentheses and its placement</td><td class="s5" dir="ltr">We need to do a product recall on Product ID 897. Can you pull a report for all customers (just First and Last name combined) who have an Sales order in our system?</td></tr><tr style="height: 20px"><th id="0R103" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">104</div></th><td class="s5" dir="ltr">Subquery in the SELECT clause</td><td class="s5" dir="ltr">Subquery is placed in the SELECT clause as a calculated field</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT FirstName+&#39; &#39;+LastName AS Customer,<br> (SELECT Count(*)<br>  FROM SalesOrderHeader<br>  WHERE SalesOrderHeader.ContactID = Contact.ContactID) AS Orders<br>FROM Contact<br>ORDER BY Customer</td><td class="s5" dir="ltr"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R104" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">105</div></th><td class="s5" dir="ltr">Subqueries with fully qualified domain names</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">SELECT FirstName+&#39; &#39;+LastName AS Customer,<br> (SELECT Count(*)<br>  FROM SalesOrderHeader s<br>  WHERE s.ContactID = c.ContactID) AS Orders<br>FROM Contact c<br>ORDER BY Customer</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">We’re doing a customer order audit. Can you provide a report of our customers order by name and the number of orders they’ve had with us to date?</td></tr><tr style="height: 20px"><th id="0R105" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">106</div></th><td class="s11" dir="ltr">Subqueries with an INSERT statement</td><td class="s11" dir="ltr">The INSERT statement uses the data returned from the subquery to insert into another table. The selected data in the subquery can be modified with any of the character, date or number functions</td><td class="s11" dir="ltr">INSERT INTO table_name <br>(column1 , column2 )<br>SELECT column1, column2<br>FROM table1 <br>WHERE [OPERATOR] [VALUE]</td><td class="s11" dir="ltr">INSERT INTO Location<br>( Name, <br>  CostRate, <br>  Availability,<br>  ModifiedDate)<br>Values<br>( &#39;Test&#39;,<br>  10,<br>  10,<br>  GetDate()</td><td class="s11" dir="ltr"></td><td class="s11" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R106" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">107</div></th><td class="s11" dir="ltr">Subqueries with an UPDATE statement</td><td class="s11" dir="ltr">The subquery can be used in conjunction with the UPDATE statement. Either single or multiple columns in a table can be updated when using a subquery with the UPDATE statement.</td><td class="s11" dir="ltr">UPDATE table<br>SET column_name = new_value<br>WHERE OPERATOR VALUE<br>(<br>   SELECT COLUMN_NAME<br>   FROM TABLE_NAME WHERE<br>)</td><td class="s11" dir="ltr">Update  Location<br>Set Name = &#39;Test3&#39;<br>Where LocationID = <br>(<br>Select <br>	LocationID<br>FROM Location<br>Where LocationID = 2<br>)</td><td class="s11" dir="ltr"></td><td class="s11" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R107" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">108</div></th><td class="s11" dir="ltr">Subqueries with a DELETE FROM statement</td><td class="s11" dir="ltr"></td><td class="s11" dir="ltr">DELETE FROM TABLE_NAME<br>WHERE OPERATOR VALUE<br>   (SELECT COLUMN_NAME<br>    FROM TABLE_NAME<br>    WHERE)</td><td class="s11" dir="ltr"></td><td class="s11" dir="ltr"></td><td class="s11" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R108" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">109</div></th><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R109" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">110</div></th><td class="s2" dir="ltr">Other</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R110" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">111</div></th><td class="s4" dir="ltr">Objective</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Notes</td><td class="s4" dir="ltr">Prompts</td></tr><tr style="height: 20px"><th id="0R111" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">112</div></th><td class="s5" dir="ltr">UNION statements</td><td class="s5" dir="ltr">Allows you to join multiple datasets into one dataset. Requires:<br>- the number and the order of the columns must be the same in all queries.<br>- the data types must be compatible.<br>Also:<br>- only one ORDER BY clause is required if an ORDER BY clause is needed</td><td class="s5" dir="ltr">SELECT <span style="color:#ff00ff;">colnameA</span>, <span style="color:#0000ff;">colnameB</span> FROM table1<br>UNION<br>SELECT <span style="color:#ff00ff;">colnameA</span>, <span style="color:#0000ff;">colnameB</span> FROM table1</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">In practice, where UNION is really useful is when you need to combine data from multiple tables, even tables with mismatched column names, in which case you can combine UNION with aliasese to retrieve a single set of results. (pg. 144)</td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R112" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">113</div></th><td class="s5" dir="ltr">  UNION</td><td class="s5" dir="ltr">returns only distinct records resulting from the UNION (i.e., removes duplicate rows)</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT <br>	v.ProductID, <br>	v.VendorID,<br>	v.StandardPrice<br>FROM <br>	ProductVendor v<br>Where v.StandardPrice &lt;= 42.2100<br>UNION<br>SELECT <br>	v.ProductID, <br>	v.VendorID,<br>	v.StandardPrice<br>FROM <br>	ProductVendor v<br>Where v.VendorID IN (50,83)<br>ORDER BY v.StandardPrice ASC;</td><td class="s5" dir="ltr">Returns the same data as this query using the WHERE clause:<br><br>SELECT v.ProductID, v.VendorID, v.StandardPrice<br>FROM ProductVendor v <br>WHERE v.StandardPrice &lt;= 42.2100<br>OR v.VendorID IN (50,83)<br>ORDER BY v.StandardPrice ASC</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R113" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">114</div></th><td class="s5" dir="ltr">  UNION ALL</td><td class="s5" dir="ltr">returns all records resulting from the UNION (i.e., does not remove duplicate rows)</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT <br>        v.ProductID, <br>        v.VendorID,<br>        v.StandardPrice<br>FROM <br>        ProductVendor v<br>Where v.StandardPrice &lt;= 42.2100<br>UNION ALL<br>SELECT <br>        v.ProductID, <br>        v.VendorID,<br>        v.StandardPrice<br>FROM <br>        ProductVendor v<br>Where v.VendorID IN (50,83)<br>ORDER BY v.StandardPrice ASC;</td><td class="s5" dir="ltr">For example, if you used the UNION ALL function on a table with itself (let&#39;s say, a table with 290 rows), you&#39;d multiply the number of rows by the number of UNION ALL commands in your statement to get 870 rows (because UNION ALL does not remove duplicate records; compare this to the same situation but with a UNION statement)</td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R114" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">115</div></th><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R115" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">116</div></th><td class="s2" dir="ltr">Joins</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R116" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">117</div></th><td class="s4" dir="ltr">Objective</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Notes</td><td class="s4" dir="ltr">Prompts</td></tr><tr style="height: 20px"><th id="0R117" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">118</div></th><td class="s5" dir="ltr">INNER JOIN</td><td class="s5" dir="ltr">An equijoin specified in either the FROM or WHERE clause that: <br>- returns all the columns in both tables<br>- returns only the rows for which there is an equal VALUE in the join column</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">- does not keep unmatched rows<br>- returns only matched rows across tables</td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R118" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">119</div></th><td class="s5" dir="ltr">+ all columns selected</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">SELECT *<br>FROM Table_name1 t1 <br>INNER JOIN Table_name2 t2<br>ON t2.column_name = t1.column_name;</td><td class="s5" dir="ltr">SELECT *<br>FROM Employee AS e<br>  INNER JOIN Contact AS c<br>  ON e.ContactID = c.ContactID<br>ORDER BY c.LastName;</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R119" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">120</div></th><td class="s5" dir="ltr">+ columns specified</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">SELECT Column_Name, Column_Name<br>FROM Table_name1 t1 <br>INNER JOIN Table_name2 t2<br>ON t2.column_name = t1.column_name;</td><td class="s5" dir="ltr">SELECT ProductVendor.VendorID, Product.ProductID, Name<br>FROM ProductVendor INNER JOIN Product <br>ON ProductVendor.ProductID = Product.ProductID</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">Can you pull a Vendor report that lists the Vendor ID along with the product IDs for products we carry?</td></tr><tr style="height: 20px"><th id="0R120" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">121</div></th><td class="s5" dir="ltr">+ columns specified + SELECT clause function</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT Top 10 ProductVendor.VendorID, Product.ProductID, Name<br>FROM ProductVendor INNER JOIN Product ON ProductVendor.ProductID = Product.ProductID<br>ORDER BY VendorID</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R121" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">122</div></th><td class="s5" dir="ltr">+ columns specified + SELECT clause function + ORDER BY clause + WHERE clause</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT TOP 100 P.ProductID, P.Name, P.ListPrice, P.Size, P.ModifiedDate, SOD.UnitPrice, SOD.UnitPriceDiscount, SOD.OrderQty, SOD.LineTotal <br>FROM SalesOrderDetail SOD INNER JOIN Product P <br>ON SOD.ProductID = P.ProductID <br>WHERE SOD.UnitPrice &gt; 1000 <br>ORDER BY SOD.UnitPrice DESC</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">Can you run a Sales Order Detail report where the Unit Price is great than $1000? I’d like to see the Unit Price (have it Sorted highest to lowest), and also show Discount, Order Quantity, and the Line total. Oh, also add the Product list price, size and date last modified to each product in the order detail report.</td></tr><tr style="height: 20px"><th id="0R122" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">123</div></th><td class="s5" dir="ltr">OUTER JOIN</td><td class="s5" dir="ltr">This type of join:<br>- returns table rows that have no associated rows in the related table (i.e, null values are included)<br>- is specified in the FROM clause only</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">Examples:<br>- Count how many orders were placed by each customer, including customers that have yet to place an order.<br>- List all products with order quantities, including products not ordered by anyone yet.<br>- Calculate average sale sizes, taking into account customers that haven&#39;t placed an order.</td></tr><tr style="height: 20px"><th id="0R123" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">124</div></th><td class="s5" dir="ltr">LEFT OUTER JOIN</td><td class="s5" dir="ltr">Unlike an inner join, the outer join will return every row from one specified table (the left side in this case), even if the join condition fails (i.e., left side keeps unmatched rows).</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT<br>  Contact.LastName,<br>  SalesOrderHeader.SalesOrderID<br>FROM<br>  Contact LEFT OUTER JOIN SalesOrderHeader <br>ON Contact.ContactID = SalesOrderHeader.ContactID <br>ORDER BY Contact.LastName ASC;</td><td class="s5" dir="ltr">- keep all left rows<br>- null values on the right side if there isn&#39;t a match<br>- outer joins are specified in the FROM clause only</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R124" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">125</div></th><td class="s5" dir="ltr">RIGHT OUTER JOIN</td><td class="s5" dir="ltr">Same as a LEFT OUTER JOIN except for the right table; return every row from the right table even if the join condition fails (i.e., right side keeps unmatched rows).</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT<br>  st.Name AS Territory, <br>  sp.SalesPersonID<br>FROM<br>  SalesTerritory st<br>RIGHT OUTER JOIN SalesPerson sp <br>ON st.TerritoryID = sp.TerritoryID ;</td><td class="s5" dir="ltr">- keep all right rows<br>- null values on the left side if there isn&#39;t a match<br>- outer joins are specified in the FROM clause only<br>- SQLITE doesn&#39;t support this</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R125" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">126</div></th><td class="s5" dir="ltr">FULL JOIN</td><td class="s5" dir="ltr">Both sides; union of matches and unmatched</td><td class="s5"></td><td class="s12" dir="ltr">SELECT ...<br>FROM a<br>FULL OUTER JOIN b ON a.key = b.key;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R126" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">127</div></th><td class="s5" dir="ltr">Implicit joins</td><td class="s5" dir="ltr">A join via the WHERE clause that does not require an explicit JOIN statement; returns the same results as INNER JOIN</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s7 softmerge" dir="ltr"><div class="softmerge-inner" style="width:773px;left:-1px">SELECT ProductVendor.VendorID, Product.ProductID, Product.Name<br>FROM ProductVendor, Product <br>WHERE ProductVendor.ProductID = Product.ProductID</div></td><td class="s9"></td><td class="s9"></td></tr><tr style="height: 20px"><th id="0R127" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">128</div></th><td class="s5" dir="ltr">CROSS JOIN</td><td class="s5" dir="ltr">A join that returns rows that are multiplication of record number from both the tables (each row on left table will related to each row of right table); AKA a Cartesian join</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s12" dir="ltr">SELECT p.SalesPersonID, t.Name AS Territory<br>FROM SalesPerson p CROSS JOIN SalesTerritory t<br>ORDER BY p.SalesPersonID;</td><td class="s5" dir="ltr">In the example: Because this query involves a join of the Employee table with itself, the Employee table appears in two roles. To distinguish these roles, you must give the Employee table two different aliases (e1 and e2) in the FROM clause. These aliases are used to qualify the column names in the rest of the query.</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R128" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">129</div></th><td class="s5" dir="ltr">Self joins</td><td class="s5" dir="ltr">A join in which the table is joined to itself</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s12 softmerge" dir="ltr"><div class="softmerge-inner" style="width:387px;left:-1px">SELECT e1.ManagerID AS ManagerID, e2.EmployeeID EmployeeID<br>FROM <span style="color:#ff00ff;">Employee e1</span> INNER JOIN <span style="color:#ff00ff;">Employee e2</span><br>ON e2.<span style="color:#0000ff;">ManagerID</span> = e1.<span style="color:#ff6d01;">EmployeeID</span><br>ORDER BY e1.ManagerID</div></td><td class="s5" dir="ltr">🚩 Note how the aliases for each column name aligns with the aliases for the table name<br>- Any column name that is duplicated between two or more tables referenced in the query must be qualified with the table name.</td><td class="s5" dir="ltr">Find the products that are supplied by more than one vendor.<br>Give me a list of employees with the employee&#39;s manager.</td></tr><tr style="height: 20px"><th id="0R129" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">130</div></th><td class="s5" dir="ltr">+ more columns specified in the SELECT clause + ORDER BY clause</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s12 softmerge" dir="ltr"><div class="softmerge-inner" style="width:387px;left:-1px">SELECT e1.EmployeeID as ManagerID, e1.Title as ManagerTitle, e2.EmployeeID, e2.Title as EmployeeTitle<br>FROM Employee e1 JOIN Employee e2<br>ON e2.ManagerID = e1.EmployeeID<br>ORDER BY e1.ManagerID</div></td><td class="s5" dir="ltr">&quot;&quot;</td><td class="s5" dir="ltr">Can you run a report for me on all Employees (listing their employee ID, Title), and their manager’s ID and title.</td></tr><tr style="height: 20px"><th id="0R130" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">131</div></th><td class="s5" dir="ltr">Multiple table join</td><td class="s5" dir="ltr">Although each join specification joins only two tables, the FROM clauses can contain multiple join specifications. This allows many tables to be joined for a single query.</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT p.Name As ProductName, v.Name AS VendorName<br>FROM Product p INNER JOIN ProductVendor pv ON p.ProductID = pv.ProductID<br>INNER JOIN Vendor v<br>ON pv.VendorID = v.VendorID<br>WHERE ProductSubcategoryID = 15<br>ORDER BY <span style="color:#000000;">v.Name</span></td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">Finds the names of all products of a particular subcategory and the names of their vendors where ProductSubCategoryID = 15.</td></tr><tr style="height: 20px"><th id="0R131" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">132</div></th><td class="s5" dir="ltr">Joins with aggregate functions</td><td class="s5" dir="ltr">INNER JOINs and OUTER JOINs with aggregate functions share the same exact syntax (just replace OUTER JOIN with INNER JOIN and vice versa with the provided example)</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT<br>   c.ContactID,<br>   c.LastName,<br>   COUNT(s.SalesOrderID) AS OrderID<br>FROM Contact c INNER JOIN SalesOrderHeader s ON c.ContactID = s.ContactID<br>GROUP BY<br>   c.LastName,<br>   c.ContactID</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R132" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">133</div></th><td class="s5" dir="ltr">Natural join</td><td class="s5" dir="ltr">A join that eliminates multiple occurences of the same column so that only one of each column is returned; requires you to select only columns that are unique yourself (which is accomplished through a wildcard SELECT * statement and then explicitly identifying columns for all other tables)</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT C.*, O.order_num, O.order_date, OI.prod_id, OI.quantity, OI.item_price<br>FROM <br>  Customers AS C, <br>  Orders as O, <br>  OrderItems AS OI<br>WHERE <br>  C.cust_id = O.cust_id <br>  AND OI.order_num = O.order_num <br>  AND prod_id = &#39;RGAN01&#39;;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R133" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">134</div></th><td class="s6" dir="ltr"></td><td class="s6"></td><td class="s6"></td><td class="s13" dir="ltr"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R134" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">135</div></th><td class="s0 softmerge" dir="ltr"><div class="softmerge-inner" style="width:509px;left:-1px">Updating, deleting and inserting data</div></td><td class="s1"></td><td class="s1"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R135" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">136</div></th><td class="s4" dir="ltr">Objective</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Notes</td><td class="s4" dir="ltr">Prompts</td></tr><tr style="height: 20px"><th id="0R136" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">137</div></th><td class="s5" dir="ltr">INSERT INTO</td><td class="s5" dir="ltr">There are basically two ways to INSERT data INTO a table: One is to INSERT it one row at a time, the other is to INSERT multiple rows at a time</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R137" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">138</div></th><td class="s5" dir="ltr">single row</td><td class="s5" dir="ltr">a single INSERT INTO statement</td><td class="s5" dir="ltr">INSERT INTO tablename<br>(column,column,column,column,column,column,column,column)<br>VALUES(<br>&#39;VALUE&#39;,<br>&#39;VALUE&#39;,<br>&#39;VALUE&#39;,<br>&#39;VALUE&#39;, NULL, NULL<br>)</td><td class="s5" dir="ltr">INSERT INTO Customers<br>(cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact, cust_email)<br>VALUES(<br>&#39;100010&#39;,<br>&#39;Pep E. LaPew&#39;, &#39;100 Main Street&#39;, &#39;Los Angeles&#39;, &#39;CA&#39;,<br>&#39;90046&#39;, NULL, NULL, NULL<br>)</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R138" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">139</div></th><td class="s5" dir="ltr">multiple rows</td><td class="s5" dir="ltr">multiple INSERT INTO statements (one for each row)</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">INSERT INTO customers<br>(cust_id, cust_name,<br>cust_address, cust_city, cust_state,<br>cust_zip, cust_country, cust_contact, cust_email) <br>VALUES (&#39;100012&#39;, &#39;Pep E. Lapew&#39;, <br>&#39;100 Main Street&#39;, &#39;Los  Angeles&#39;, &#39;CA&#39;,<br>&#39;91108&#39;,&#39;USA&#39;,<br>&#39;Pep E. Lapew&#39;, &#39;plapew@plapew.org&#39;)<br><br>INSERT INTO customers<br>(cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact, cust_email) VALUES<br>(&#39;100013&#39;, &#39;M. Martin&#39;, &#39;42 Galaxy Way&#39;, &#39;New York&#39;,&#39;NY&#39;,<br>&#39;11213&#39;,&#39;USA&#39;,&#39;M. Martin&#39;, &#39;mmartin@mmartin.org&#39;)</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R139" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">140</div></th><td class="s5" dir="ltr">SELECT INTO</td><td class="s5" dir="ltr">Another way to add data is using the INTO in a SELECT statement. This allows you to INSERT data from a single table or multiple tables using table joins. You can think of the SELECT INTO as being an export operation.<br><br>The INTO statement allows you to copy the data from one table into a new table. The keyword INTO actually creates the new table.</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT<br>cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact, cust_email INTO<br>customers2<br>FROM Customers;<br><br>-- Insert a row to the new customers2 table<br>INSERT INTO customers2<br>(<br>cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact, cust_email<br>) VALUES<br>(<br>&#39;100014&#39;, &#39;J. Verne&#39;, <br>&#39;12 Timetravel Way&#39;, &#39;New York&#39;,&#39;NY&#39;,<br>&#39;11213&#39;,&#39;USA&#39;,<br>&#39;J. Verne&#39;, &#39;jverne@jverne.org&#39;<br>)</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R140" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">141</div></th><td class="s5" dir="ltr">+ but with different columns from the SELECT statement and the INSERT INTO statement</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT<br>cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact, cust_email <br>INTO customers2<br>From Customers;<br><br>-- Now let’s insert a row to the new customers2 table<br>INSERT INTO Customers2<br>(cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact, cust_email<br>) <br>VALUES<br>(<br>&#39;J. Verne&#39;, <br>&#39;12 Timetravel Way&#39;, <br>&#39;New York&#39;,<br>&#39;NY&#39;,<br>&#39;11213&#39;,<br>&#39;USA&#39;,<br>&#39;J. Verne&#39;,<br>&#39;jverne@jverne.org&#39;<br>)</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R141" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">142</div></th><td class="s5" dir="ltr">SELECT INTO [to copy an entire table]</td><td class="s5" dir="ltr">Used to copy the contents of a table into a brand new table; <span style="font-weight:bold;">like exporting data </span>(pg. 152)<br>- any SELECT options and clauses may be used (e.g., WHERE, GROUP BY, etc.)<br>- joins may be used to insert data<br>- data is inserted into a single table</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT *<br>INTO CustCopy<br>From Customers;</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R142" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">143</div></th><td class="s5" dir="ltr">INSERT SELECT</td><td class="s5" dir="ltr">i.e., inserting retrieved data<br>- made up of both the INSERT and the SELECT statement. <br>- <span style="font-weight:bold;">like importing data</span><br>- if you wanted to add customers from another table to the customers table all at one time you would use the INSERT SELECT statement.</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">INSERT INTO customers (<br> cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact, cust_email<br>)<br>SELECT cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact, cust_email<br>FROM Customers2<br>WHERE cust_id=’100014’</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R143" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">144</div></th><td class="s5" dir="ltr">INSERT Data Using WHERE Clause</td><td class="s5" dir="ltr">- the WHERE clause is used to filter specific rows.<br>- this method allows you to limit what data you are INSERTING.</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">INSERT INTO customers <br>(<br>cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact, cust_email<br>) <br>SELECT cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact, cust_email <br>FROM Customers2 <br>WHERE cust_id = &#39;111111&#39;</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R144" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">145</div></th><td class="s5" dir="ltr">UPDATE</td><td class="s5" dir="ltr">- used to modify data in a table (i.e., it updates existing records in a table); can modify specific rows or all rows in a table.<br>- the WHERE clause specifies which record or records that should be updated.<br>- all records will be updated without the WHERE clause.</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">- Never use an UPDATE or DELETE without the WHERE clause<br>- Make sure every table has a primary key<br>- Before using UPDATE or DELETE first test with SELECT statement<br>- Use database-enforced Referential Integrity, which will not allow rows that are referenced elsewhere to be updated/deleted without authorization or credentials to do so</td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R145" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">146</div></th><td class="s5" dir="ltr">single column</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">UPDATE table_name<br>SET column1=value1<br>WHERE some_column=some_value;</td><td class="s5" dir="ltr">UPDATE customers<br>SET cust_email = &#39;elmer@fudd.com&#39; <br>WHERE cust_id = &#39;100011&#39;</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R146" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">147</div></th><td class="s5" dir="ltr">multiple columns</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">UPDATE table_name<br>SET column1=value1,column2=value2<br>WHERE some_column=some_value;</td><td class="s5" dir="ltr">UPDATE customers<br>SET cust_name = &#39;The Fudds&#39;, cust_email = &#39;elmer@fudd.com&#39; WHERE cust_id = &#39;100011&#39;</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R147" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">148</div></th><td class="s5" dir="ltr">CREATE table</td><td class="s5" dir="ltr">Creates a copy of a table from a SELECT statement</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE TABLE CustCopy AS<br>SELECT * FROM Customers;</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R148" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">149</div></th><td class="s5" dir="ltr">DELETE</td><td class="s5" dir="ltr">- used to delete data in a table; can delete specific rows or all rows in a table<br>- to avoid deleting all records in a table, the WHERE clause should not be omitted with the DELETE statement (similar to the UPDATE statement)</td><td class="s5" dir="ltr">DELETE FROM table_name<br>WHERE some_column=some_value;</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">- Never use an UPDATE or DELETE without the WHERE clause<br>- Make sure every table has a primary key<br>- Before using UPDATE or DELETE first test with SELECT statement<br>- Use database-enforced Referential Integrity</td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R149" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">150</div></th><td class="s5" dir="ltr">DELETING using the UPDATE statement</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">UPDATE customers<br>SET cust_city = NULL<br>WHERE cust_id = &#39;111111&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R150" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">151</div></th><td class="s5" dir="ltr">DELETING a single row</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">DELETE FROM customers <br>WHERE cust_id = &#39;100012&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R151" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">152</div></th><td class="s5" dir="ltr">ALTER TABLE</td><td class="s5" dir="ltr">Used to modify the structure of an existing table in a database. It allows for various changes without necessarily losing the data within the table</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">ALTER TABLE customers2<br>ADD CONSTRAINT pk_customers2 PRIMARY KEY (cust_id);</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R152" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">153</div></th><td class="s5" dir="ltr">DROP TABLE</td><td class="s5" dir="ltr">Removes all the data and the entire definition of the table, including any primary keys, indexes, foreign keys, and any link to the table</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">DROP TABLE Customer2;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R153" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">154</div></th><td class="s5" dir="ltr">TRUNCATE TABLE</td><td class="s5" dir="ltr">TRUNCATE TABLE removes all rows from a table just like the Delete from command. TRUNCATE TABLE is faster and uses fewer system resources because it does not log every delete transaction in the log file</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">TRUNCATE TABLE customers2;<br>SELECT * <br>FROM customers2;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R154" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">155</div></th><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R155" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">156</div></th><td class="s2" dir="ltr">Creating tables</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R156" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">157</div></th><td class="s4" dir="ltr">Objective</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Notes</td><td class="s4" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R157" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">158</div></th><td class="s5" dir="ltr">CREATE TABLE</td><td class="s5" dir="ltr">- The column_name parameters specify the names of the columns of the table.<br>- The data_type parameter specifies what type of data the column can hold (e.g. varchar, integer, decimal, date, etc.).<br>- The size parameter specifies the maximum length of the column of the table.</td><td class="s5" dir="ltr">CREATE TABLE table_name<br>(<br>column_name1 data_type(size),<br>column_name2 data_type(size),<br>column_name3 data_type(size)<br>);</td><td class="s5" dir="ltr">CREATE TABLE Products2<br>(<br>prod_id        CHAR(10)       NOT NULL,<br>vend_id        CHAR(10)       NOT NULL,<br>prod_name      CHAR(254)      NOT NULL,<br>prod_price     DECIMAL(8,2)   NOT NULL,<br>prod_desc      VARCHAR(1000)  NULL<br>);</td><td class="s5" dir="ltr">- When creating a new table the table name must be unique in the database.<br>- Table columns need to be defined as a certain datatype, i.e varchar, datetime, etc.<br>- Create Primary Key (PK): You can do this during table initial creation or after. PK only on columns that do not allow NULL</td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R158" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">159</div></th><td class="s5" dir="ltr">all columns required</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE TABLE Orders<br>(<br>order_num    INTEGER       NOT NULL,<br>order_date   DATETIME      NOT NULL,<br>cust_id      CHAR(10)      NOT NULL<br>);</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R159" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">160</div></th><td class="s5" dir="ltr">NULL and NOT NULL values, where NULL isn&#39;t specified</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE TABLE Vendors<br>(<br>prod_id        CHAR(10)  NOT NULL,<br>vend_id        CHAR(50)  NOT NULL,<br>prod_name      CHAR(50)  ,<br>prod_price     CHAR(50)  ,<br>prod_desc      CHAR(5)   ,<br>prod_desc      CHAR(10)  ,<br>prod_desc      CHAR(50)<br>);</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R160" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">161</div></th><td class="s5" dir="ltr">DEFAULT 1</td><td class="s5" dir="ltr">instructs the DBMS to use a quantity of 1 of no quantity is specified</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE TABLE OrderItems<br>(<br>order_num    INTEGER     NOT NULL,<br>order_item   INTEGER     NOT NULL,<br>prod_id      CHAR(10)    NOT NULL,<br>quantity     INTEGER     NOT NULL   DEFAULT 1,<br>item_price   DECIMAL(8,2)   <br>);</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R161" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">162</div></th><td class="s5" dir="ltr">create a table and set the primary key</td><td class="s5" dir="ltr">- Creates the Primary, sets it as an Identity Key and set the CreatedDateTime as Default GetDate() <br>- This is done on the initial table creation</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE TABLE Persons2<br> (<br> PersonID int Identity(1,1) Primary Key,<br> LastName varchar(255),<br> FirstName varchar(255),<br> Address varchar(255),<br> City varchar(255),<br>CreatedDateTime DateTime Default GetDate()<br> ); </td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R162" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">163</div></th><td class="s5" dir="ltr">ALTER TABLE</td><td class="s5" dir="ltr">updates a table by adding, deleting or modifying columns in an existing table<br>- Specify the table you want to ALTER<br>- Specify the list of changes to be made<br>- Use ALTER statement to create Foreign Keys</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">SQLite does not support the use of ALTER TABLE to define primary and foreign keys (these must be defined at initial CREATE TABLE time)</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R163" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">164</div></th><td class="s5" dir="ltr">add column</td><td class="s5" dir="ltr">Adds columns to a table</td><td class="s5" dir="ltr">ALTER TABLE table_name<br>ADD column_name datatype</td><td class="s5" dir="ltr">ALTER TABLE Vendors<br>ADD vend_phone CHAR(20)</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R164" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">165</div></th><td class="s5" dir="ltr">edit a column</td><td class="s5" dir="ltr">Edits a column&#39;s data type</td><td class="s5" dir="ltr">ALTER TABLE table_name<br>ALTER COLUMN column_name datatype</td><td class="s5" dir="ltr">ALTER TABLE Persons2<br>ALTER COLUMN Address VARCHAR(100)</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R165" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">166</div></th><td class="s5" dir="ltr">edit a column&#39;s default value</td><td class="s5" dir="ltr">Sets a column to a default value</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">ALTER TABLE Person2<br>ADD DEFAULT &#39;Los Angeles&#39; FOR city</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R166" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">167</div></th><td class="s5" dir="ltr">edits a column&#39;s default value</td><td class="s5" dir="ltr">Drops a column&#39;s DEFAULT constraint</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">ALTER TABLE Persons<br>ALTER COLUMN City DROP DEFAULT</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R167" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">168</div></th><td class="s5" dir="ltr">edit a column&#39;s primary key</td><td class="s5" dir="ltr">To modify a table and add a primary key, use the ALTER TABLE command</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">ALTER TABLE vendors2<br>ADD CONSTRAINT pk_vendors2 PRIMARY KEY (vend2_id);</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R168" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">169</div></th><td class="s5" dir="ltr">set two primary keys</td><td class="s5" dir="ltr">sets two primary keys for a given table</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">ALTER TABLE orderitems2<br>ADD CONSTRAINT pk_orderitems2 PRIMARY KEY (order2_num, order_item);</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R169" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">170</div></th><td class="s5" dir="ltr">+ DROP COLUMN</td><td class="s5" dir="ltr">drops columns from a table</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">ALTER TABLE Vendors<br>DROP COLUMN vend_phone;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R170" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">171</div></th><td class="s5" dir="ltr">DROP TABLE</td><td class="s5" dir="ltr">drops an entire table</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">DROP TABLE CustCopy;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R171" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">172</div></th><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R172" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">173</div></th><td class="s2" dir="ltr">Creating views</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R173" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">174</div></th><td class="s4" dir="ltr">Objective</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Notes</td><td class="s4" dir="ltr">Results</td></tr><tr style="height: 20px"><th id="0R174" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">175</div></th><td class="s5" dir="ltr">CREATE VIEW ... AS</td><td class="s5" dir="ltr">a statement to create a virtual table; unlike tables that contain data, views simply contain queries that dynamically retrieve data when used. always shows up-to-date data</td><td class="s5" dir="ltr">CREATE VIEW view_name AS<br>SELECT column_name(s)<br>FROM table_name<br>WHERE condition</td><td class="s5" dir="ltr">CREATE VIEW ProductCustomers AS<br>SELECT cust_name, cust_contact, prod_id<br>FROM Customers, Orders, OrderItems<br>WHERE Customers.cust_id = Orders.cust_id AND OrderItems.order_num = Orders.order_num</td><td class="s5" dir="ltr">Requirements:<br>- Must have unique name<br>- No limit as to number of views<br>- You must have security access<br>- Views can be nested<br>- Views cannot be indexed<br>- ORDER BY is prohibited in view queries*<br>- every column returned must be named (which requires the use of aliases if columns are calculated fields)<br>- some DBMSs treat views as read-only queries**<br>- some DBMSs allow you to create views that do not allow rows to be inserted or updated if that insertion or update will cause that row to no longer be a part of that view***</td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R175" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">176</div></th><td class="s5" dir="ltr">[additional query]</td><td class="s5" dir="ltr">a query pulling from the view created in the above CREATE VIEW statement example</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SELECT cust_name, cust_contact<br>FROM ProductCustomers<br>WHERE prod_id = &#39;RGAN01&#39;;<br><br>-- in this case, ProductCustomers is a <span style="font-weight:bold;">view</span> created from another query and we are pulling from this table with the above query</td><td class="s5" dir="ltr"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R176" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">177</div></th><td class="s5" dir="ltr">CREATE VIEW + concatentation</td><td class="s5" dir="ltr">another CREATE VIEW statement but this time with a concatenation use case</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE VIEW VendorLocations AS<br>SELECT RTRIM(vend_name) + &#39; (&#39; + RTRIM(vend_country) + &#39;)&#39; AS vend_title<br>FROM Vendors;</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">vend_title<br>Bear Emporium (USA)<br>Bears R Us (USA)<br>Doll House Inc. (USA)<br>Fun and Games (England)<br>Furball Inc. (USA)<br>Jouets et ours (France)</td></tr><tr style="height: 20px"><th id="0R177" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">178</div></th><td class="s5" dir="ltr">[additional query]</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">SELECT * <br>FROM VendorLocations;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R178" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">179</div></th><td class="s5" dir="ltr">CREATE VIEW + WHERE clause</td><td class="s5" dir="ltr">another CREATE VIEW statement but this time with a WHERE clause</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE VIEW CustomerEmailList AS<br>SELECT cust_id, cust_name, cust_email<br>FROM Customers<br>WHERE cust_email IS NOT NULL;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R179" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">180</div></th><td class="s5" dir="ltr">[additional query]</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">SELECT * <br>FROM CustomerEmailList;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R180" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">181</div></th><td class="s5" dir="ltr">CREATE VIEW + calculated fields + column aliases</td><td class="s5" dir="ltr">another CREATE VIEW statement but this time with calculated fields and aliases</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE VIEW OrderItemsExpanded AS<br>SELECT order_num,<br>       prod_id,<br>       quantity,<br>       item_price,<br>       quantity*item_price AS expanded_price<br>FROM OrderItems;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R181" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">182</div></th><td class="s5" dir="ltr">[additional query]</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">SELECT *<br>FROM OrderItemsExpanded<br>WHERE order_num = 20008;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R182" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">183</div></th><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R183" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">184</div></th><td class="s2" dir="ltr">Transactions</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R184" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">185</div></th><td class="s4" dir="ltr">Objective</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Notes</td><td class="s4" dir="ltr">Results</td></tr><tr style="height: 20px"><th id="0R185" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">186</div></th><td class="s5" dir="ltr">BEGIN/COMMIT TRANSACTION</td><td class="s5" dir="ltr">SQL requires that you explicitly mark the beginning and end of a transaction</td><td class="s5" dir="ltr">BEGIN TRANSACTION<br>...<br>COMMIT TRANSACTION</td><td class="s5" dir="ltr">BEGIN TRANSACTION<br>DELETE OrderItems WHERE order_num = 12345<br>DELETE Orders WHERE order_num = 12345<br>COMMIT TRANSACTION</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R186" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">187</div></th><td class="s5" dir="ltr">+ SAVE TRANSACTION + ROLLBACK TRANSACTION</td><td class="s5" dir="ltr">see glossary &gt;&gt;</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">BEGIN TRANSACTION<br>INSERT INTO Customers(cust_id, cust_name)<br>VALUES(&#39;100000010&#39;, &#39;Toys Emporium&#39;);<br>SAVE TRANSACTION StartOrder;<br>INSERT INTO Orders(order_num, order_date, cust_id)<br>VALUES(20100, &#39;2001/12/1&#39;, &#39;100000010&#39;);<br>IF @@ERROR &lt;&gt; 0 ROLLBACK TRANSACTION StartOrder;<br>INSERT INTO OrderItems(order_num, order_item, prod_id, quantity, item_price)<br>VALUES(<span style="color:#ff00ff;">20100</span>, <span style="color:#ff00ff;">1</span>, &#39;BR01&#39;, 100, 5.49);<br>IF @@ERROR &lt;&gt; 0 ROLLBACK TRANSACTION StartOrder;<br>INSERT INTO OrderItems(order_num, order_item, prod_id, quantity, item_price)<br>VALUES(<span style="color:#ff00ff;">20100</span>, <span style="color:#ff00ff;">2</span>, &#39;BR03&#39;, 100, 10.99)<br>IF @@ERROR &lt;&gt; 0 ROLLBACK TRANSACTION StartOrder;<br>COMMIT TRANSACTION</td><td class="s5" dir="ltr"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R187" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">188</div></th><td class="s5" dir="ltr">&quot;&quot; but with example errors</td><td class="s5" dir="ltr">Same transaction as above except with values that produce errors (intended)</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">BEGIN TRANSACTION<br>INSERT INTO Customers(cust_id, cust_name)<br>VALUES(&#39;1000000010&#39;, &#39;Toys Emporium&#39;);<br>SAVE TRANSACTION StartOrder;<br>INSERT INTO Orders(order_num, order_date, cust_id)<br>VALUES(20100,&#39;2001/12/1&#39;,&#39;1000000010&#39;);<br>IF @@ERROR &lt;&gt; 0 ROLLBACK TRANSACTION StartOrder;<br>INSERT INTO OrderItems(order_num, order_item,  prod_id, quantity, item_price)<br>VALUES(<span style="color:#ff00ff;">20005</span>, <span style="color:#ff00ff;">3</span>, &#39;BR01&#39;, 100, 5.49);<br>IF @@ERROR &lt;&gt; 0 ROLLBACK TRANSACTION StartOrder;<br>INSERT INTO OrderItems(order_num, order_item,  prod_id, quantity, item_price)<br>VALUES(<span style="color:#ff00ff;">20006</span>, <span style="color:#ff00ff;">3</span>, &#39;BR03&#39;, 100, 10.99);<br>IF @@ERROR &lt;&gt; 0 ROLLBACK TRANSACTION StartOrder;<br>COMMIT TRANSACTION</td><td class="s5" dir="ltr">(1 row affected) <br>(1 row affected) <br>(1 row affected) 	<br>Msg 2627, Level 14, State 1, Line 14<br>Violation of PRIMARY KEY constraint &#39;PK_OrderItems&#39;. Cannot insert duplicate key in object &#39;dbo.OrderItems&#39;. The duplicate key value is (20006, 3). <br>	<br>Msg 3621, Level 0, State 0, Line 14<br>The statement has been terminated. <br>Total execution time: 00:00:00.011</td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R188" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">189</div></th><td class="s5" dir="ltr">BEGIN + DELETE + COMMIT</td><td class="s5" dir="ltr">Transaction to delete order number 20010 from two separate tables</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--Start the transaction<br>BEGIN TRANSACTION<br>SET IDENTITY_INSERT orderitems ON<br>--Delete all rows        <br>Delete From orderitems Where order_num = 20010;<br>Delete From orders Where order_num = 20010;<br>SET IDENTITY_INSERT orderitems OFF<br>--Commit the delete statement only if no error occurs<br>Commit;</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R189" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">190</div></th><td class="s5" dir="ltr">ROLLBACK</td><td class="s5" dir="ltr">see glossary &gt;&gt;</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">DELETE FROM Orders;<br>ROLLBACK;</td><td class="s5" dir="ltr"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R190" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">191</div></th><td class="s5" dir="ltr">ROLLBACK TRANSACTION</td><td class="s5" dir="ltr">see glossary &gt;&gt;</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">ROLLBACK TRANSACTION delete1;</td><td class="s5" dir="ltr"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R191" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">192</div></th><td class="s5" dir="ltr">SAVE TRANSACTION</td><td class="s5" dir="ltr">see glossary &gt;&gt;</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">SAVE TRANSACTION delete1;</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R192" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">193</div></th><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R193" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">194</div></th><td class="s2" dir="ltr">Stored Procedures</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R194" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">195</div></th><td class="s4" dir="ltr">Objective</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Notes</td><td class="s4" dir="ltr">Results</td></tr><tr style="height: 20px"><th id="0R195" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">196</div></th><td class="s5" dir="ltr">EXECUTE</td><td class="s5" dir="ltr">[Example] adds a new product to the Products table</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">EXECUTE AddNewProduct(&#39;JTS01&#39;,<br>&#39;Stuffed Eiffel Tower&#39;,<br>6.49,<br>&#39;Plush stuffed toy with the text La Tour Eiffel in red white and blue&#39;);</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R196" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">197</div></th><td class="s5" dir="ltr">CREATE PROCEDURE</td><td class="s5" dir="ltr">[Example] a stored procedure that counts the number of customers in a mailing list who have email addresses</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE PROCEDURE MailingListCount<br>AS<br>DECLARE @cnt INTEGER<br>SELECT @cnt = COUNT(*)<br>FROM Customers<br>WHERE NOT cust_email IS NULL;<br>RETURN @cnt</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R197" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">198</div></th><td class="s5" dir="ltr">+ DECLARE</td><td class="s5" dir="ltr">invokes the CREATE PROCEDURE statement above (specific to SMSS only); specifically, it declares a variable to hold whatever the stored procedure returns, executes the stored procedure, and then uses a SELECT statement to display the returned value</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">DECLARE @ReturnValue INT<br>EXECUTE @ReturnValue=MailingListCount;<br>SELECT @ReturnValue;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R198" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">199</div></th><td class="s5" dir="ltr">CREATE PROCEDURE</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE PROCEDURE NewOrder @cust_id CHAR(10)<br>AS<br>DECLARE @order_num INTEGER<br>SELECT @order_num=MAX(order_num)<br>FROM Orders<br>SELECT @order_num=@order_num+1<br>INSERT INTO Orders(order_num, order_date, cust_id)<br>VALUES (@order_num, GETDATE(), @cust_id)<br>RETURN @order_num</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R199" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">200</div></th><td class="s5" dir="ltr">CREATE PROCEDURE</td><td class="s5" dir="ltr">Queries the Address table and creates a variable @City, which we can specify in the statement that invokes the procedure (EXECUTE). This example assumes there will be an exact match on the City value that is passed.</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE PROCEDURE uspGetAddress <br>@City nvarchar(30) <br>AS <br>SELECT * <br>FROM Address <br>WHERE City = @City </td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R200" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">201</div></th><td class="s5" dir="ltr">+ EXECUTE</td><td class="s5" dir="ltr">Invokes the previous procedure; can change the variable value to whatever and query it as needed</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">EXEC uspGetAddress @City = &#39;New York&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R201" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">202</div></th><td class="s5" dir="ltr">CREATE PROCEDURE</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">-- this procedure gets a list of addresses based on the @City value that is passed<br>CREATE PROCEDURE uspGetAddressCount <br>@City nvarchar(30), <br>@AddressCount int OUTPUT <br>AS <br>SELECT @AddressCount = count(*) <br>FROM Address <br>WHERE City = @City </td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R202" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">203</div></th><td class="s5" dir="ltr">+ EXECUTE</td><td class="s5" dir="ltr">Invokes the previous procedure<br>1. declares a variable<br>2. executes the stored procedure<br>3. selects the returned valued</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">DECLARE @AddressCount int EXEC uspGetAddressCount @City = &#39;Calgary&#39;, @AddressCount = @AddressCount OUTPUT SELECT @AddressCount </td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R203" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">204</div></th><td class="s5" dir="ltr">CREATE PROCEDURE</td><td class="s5" dir="ltr">Creates a stored procedure to return average product price</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--Create sp to return average product price<br>CREATE PROCEDURE usp_productpricing AS<br>BEGIN<br>  SELECT Avg(prod_price) AS priceaverage<br>  FROM products<br>END;</td><td class="s5" dir="ltr"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R204" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">205</div></th><td class="s5" dir="ltr">+ EXECUTE</td><td class="s5" dir="ltr">Invokes the previous procedure</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">EXEC usp_productpricing</td><td class="s5" dir="ltr">priceaverage<br>6.823333</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R205" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">206</div></th><td class="s5" dir="ltr">CREATE PROCEDURE</td><td class="s5" dir="ltr">see <span style="text-decoration:underline;text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;"><a target="_blank" href="https://docs.google.com/document/d/1nmEaI03dukfPe-yRYf2wghnlxNnX_tUnodvIkEaiRfM/edit?tab=t.0">this doc</a></span></td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">Create PROCEDURE [dbo].[usp_productpricing] <br>@price_min Money OUTPUT,<br>@price_max Money OUTPUT,<br>@price_avg Money OUTPUT<br>AS<br>BEGIN<br>  SELECT @price_min= Min(prod_price)<br>  FROM products;<br>  SELECT @price_max= Max(prod_price)<br>  FROM products;<br>  SELECT @price_avg= Avg(prod_price)<br>  FROM products;<br>END;</td><td class="s5" dir="ltr"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R206" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">207</div></th><td class="s5" dir="ltr">+ GO + DECLARE + OUTPUT + SELECT</td><td class="s5" dir="ltr">Invokes the previous procedure</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">GO <br>--This declares variables to store values from parameters<br>DECLARE @cheap Money<br>DECLARE @expensive Money<br>DECLARE @average Money<br>--This code executes stored procedure and populates variables<br>exec usp_productpricing @cheap OUTPUT,<br>  @expensive OUTPUT,<br>  @average OUTPUT<br>--This code displays variable vaules that are passed from the parameters.<br>SELECT <br>  @cheap AS Cheap, <br>  @expensive AS Expensive, <br>  @average AS Average</td><td class="s5" dir="ltr">Cheap	 Expensive   Average<br>3.4900	 11.9900     6.8233</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R207" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">208</div></th><td class="s5" dir="ltr">CREATE PROCEDURE</td><td class="s5" dir="ltr">Passes in a parameter to the stored procedure and returns an OUTPUT parameter</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE PROCEDURE usp_ordertotal<br>    @order_num INT,<br>    @order_total Money OUTPUT<br>AS<br>BEGIN<br>  SELECT <br>    @order_total = SUM(item_price*quantity)<br>  FROM        orderitems<br>  WHERE order_num = @order_num;<br>END;</td><td class="s5" dir="ltr"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R208" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">209</div></th><td class="s5" dir="ltr">+ DECLARE + EXECUTE + OUTPUT + SELECT</td><td class="s5" dir="ltr">Invokes the previous procedure</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">DECLARE @order_total Money<br>EXECUTE usp_ordertotal 20009, @order_total OUTPUT<br>SELECT @order_total AS OrderTotal</td><td class="s5" dir="ltr">OrderTotal<br>1867.5000</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R209" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">210</div></th><td class="s5" dir="ltr">CREATE PROCEDURE</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">-- Name: ordertotal<br>-- Parameters: @order_num = order number<br>-- @taxable = 0 if not taxable, 1 if taxable<br>-- @order_total = order total variable<br>ALTER PROCEDURE usp_ordertotal<br>  @order_num INT,<br>  @taxable BIT,<br>  @order_total Money OUTPUT<br>AS<br>BEGIN<br>  --Declare variable for total<br>  DECLARE @total Money;<br>  --Declare tax percentage<br>  DECLARE @taxrate INT;<br>  --Set tax rate <br>  SET @taxrate = 6;<br>  --Get the order total<br>  SELECT @total = SUM(item_price*quantity)<br>  FROM orderitems<br>  WHERE order_num = @order_num<br>  --Is this taxable?<br>  If @taxable = 1<br>  --Yes, so add taxrate to the total<br>  SET @total=@total+(@total/100*@taxrate);<br>  -- And finally, save to OUTPUT variable<br>  SELECT @order_total= @total;<br>END;</td><td class="s5" dir="ltr"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R210" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">211</div></th><td class="s5" dir="ltr">+ DECLARE + EXECUTE + OUTPUT + SELECT</td><td class="s5" dir="ltr">Invokes the previous procedure</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">DECLARE @order_total Money<br>EXECUTE usp_ordertotal 20005, 0, @order_total OUTPUT<br>SELECT @order_total AS OrderTotal</td><td class="s5" dir="ltr">OrderTotal<br>1648.0000</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R211" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">212</div></th><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R212" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">213</div></th><td class="s2" dir="ltr">Variables</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R213" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">214</div></th><td class="s4" dir="ltr">Objective</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Notes</td><td class="s4" dir="ltr">Results</td></tr><tr style="height: 20px"><th id="0R214" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">215</div></th><td class="s5" dir="ltr">DECLARE</td><td class="s5" dir="ltr">Declares a variable</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">DECLARE @TestVariable varchar(30) <br>SET @TestVariable = &#39;White&#39; <br>PRINT @TestVariable GO<br>SELECT @TestVariable AS &#39;Column1&#39;</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr"></td></tr><tr style="height: 20px"><th id="0R215" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">216</div></th><td class="s5" dir="ltr">DECLARE</td><td class="s5" dir="ltr">Declares a variable</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">-- 1. Declare variables<br>Declare @age Int;<br>Declare @firstname Varchar(20), @lastname Varchar(20)</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R216" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">217</div></th><td class="s5" dir="ltr">SET</td><td class="s5" dir="ltr">Assign values to variables; sets only one variable value at a time (compare to SELECT statement, which sets multiple)</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">-- 2. Set variable values<br>SET @firstname = &#39;Forta&#39;        <br>SET @lastname = &#39;Ben&#39;<br>SET @age = 21</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R217" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">218</div></th><td class="s5" dir="ltr">PRINT</td><td class="s5" dir="ltr">Prints the variable&#39;s value</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">-- 3. Output the contents<br>Print @firstname<br>Print @lastname<br>Print @age</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R218" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">219</div></th><td class="s5" dir="ltr">+ concatenate</td><td class="s5" dir="ltr">Another variation of the same PRINT statement as above but using concatenation</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">-- 3. Output the contents<br>PRINT @lastname+&#39;, &#39;+@firstname<br>PRINT @age</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R219" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">220</div></th><td class="s5" dir="ltr">+ concatenate + CONVERT</td><td class="s5" dir="ltr">Same PRINT statement as above but with concatenate and CONVERT</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--3. This code outputs contents<br>PRINT &#39;Name:&#39;+ @lastname+&#39;, &#39;+@firstname<br>PRINT &#39;Age: &#39;+ Convert(varchar,@age)</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R220" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">221</div></th><td class="s5" dir="ltr">+ concatenate (all variables) + CONVERT</td><td class="s5" dir="ltr">Same PRINT statement as above but concatenating all variables set in part 2; also contains a CONVERT statement</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--3. This code outputs contents<br>PRINT @firstname + @lastname + Convert(Varchar(20),@age)</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R221" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">222</div></th><td class="s5" dir="ltr">SELECT</td><td class="s5" dir="ltr">Assign values to variables using a SELECT statement; sets multiple variable values in a single statement (compare to SET)</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--This code declares your variables<br>Declare @age Int;<br>Declare @firstname Varchar(20), @lastname Varchar(20)<br>--This code sets the value<br>Select @firstname=&#39;Forta&#39;, @lastname=&#39;Ben&#39;, @age=21</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R222" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">223</div></th><td class="s5" dir="ltr">Using Variables in Statements</td><td class="s5" dir="ltr">This task requires two select statements:<br>1. One query will return customer information for a specific customer. <br>2. The second query will return orders placed by that customer. <br>This is called BATCH-PROCESSING. Batch-Processing is a set of SQL Statements all submitted together to the Server.</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--This query returns customer data<br>SELECT cust_name, cust_email <br>FROM customers<br>WHERE cust_id = 1000000001<br><br>--This query returns orders placed by customer<br>SELECT order_num, order_date<br>FROM orders<br>WHERE cust_id = 1000000001<br>ORDER BY order_date</td><td class="s5" dir="ltr">cust_name                                cust_email<br>Village Toys                                              sales@villagetoys.com                                                                                                                                                                                                                                          <br><br>order_num        order_date<br>20009                2012-02-08 00:00:00.000<br>20005                2012-05-01 00:00:00.000</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R223" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">224</div></th><td class="s5" dir="ltr">[comparison]</td><td class="s5" dir="ltr">The following SQL code submits both statements together and returns the data we need in two separate select statements. However, in this select statement we use a declared variable for cust_id. This variable replaces the cust_id number as shown.</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--This code declares your variables<br>DECLARE @cust_id int;<br>SET @cust_id = 1000000001;<br>--This query returns customer data<br>SELECT cust_name, cust_email <br>FROM customers<br>WHERE cust_id = @cust_id<br><br>--This query returns orders placed by customer<br>SELECT order_num, order_date<br>FROM orders<br>WHERE cust_id = @cust_id<br>ORDER BY order_date</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R224" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">225</div></th><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6" dir="ltr"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R225" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">226</div></th><td class="s2" dir="ltr">Conditional processing</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R226" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">227</div></th><td class="s4" dir="ltr">Objective</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Notes</td><td class="s4" dir="ltr">Results</td></tr><tr style="height: 20px"><th id="0R227" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">228</div></th><td class="s5" dir="ltr">Using Conditional Processing</td><td class="s5" dir="ltr">The following SQL code returns the current date and the day of the week</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--The GetDate() returns the current datetime<br>SELECT Getdate()<br>--This DatePart() returns the day of the week<br>SELECT DatePart(dw, getdate())</td><td class="s5" dir="ltr">(No column name)<br>2017-11-06 20:07:09.527<br>(No column name)<br>2017-11-06 20:07:09.527</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R228" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">229</div></th><td class="s5" dir="ltr">[comparison]</td><td class="s5" dir="ltr">An IF statement that sets a variable to either 0 or 1 based on whether or not today’s date equals the DatePart() day of the week (Sunday)</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--Declare variable<br>DECLARE @open bit<br>--Open for business today?<br>IF DatePart(dw, GetDate()) = 7<br>SET @open = 0<br>ELSE SET @open =1<br>--Output contents of @open<br>SELECT @open as OpenForBusiness</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R229" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">230</div></th><td class="s5" dir="ltr">[comparison]</td><td class="s5" dir="ltr">Similar to the previous example, but takes into account Saturday and Sunday</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--Declare variable<br>DECLARE @open bit<br>Declare @dow numeric<br>--Get  day of week <br>SET @dow = DatePart(dw, GetDate());<br>--Open for business today?<br>IF @dow = 6 or @dow = 7 SET @open = 0<br>ELSE SET @open =1<br>--Output contents of @open<br>SELECT @open as OpenForBusiness</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R230" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">231</div></th><td class="s5" dir="ltr">[comparison]</td><td class="s5" dir="ltr">Similar to the previous example, but does not use the new @dow variable</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--Declare variable<br>DECLARE @open bit<br>DECLARE @dow INT<br>--Open for business today?<br>IF DatePart(dw, GetDate()) = 6 or DatePart(dw, GetDate()) = 7 <br>SET @open = 0<br>ELSE SET @open =1<br>--Output contents of @open<br>SELECT @open as OpenForBusiness</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R231" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">232</div></th><td class="s5" dir="ltr">Grouping statements</td><td class="s5" dir="ltr">Executes multiple statements in a block; uses an IF/ELSE statement</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--Declare variable<br>DECLARE @open bit<br>DECLARE @dow INT, @process bit<br>--Get day of week <br>SET @dow = DatePart(dw, GetDate());<br>--Open for business today?<br>IF @dow = 6 or @dow = 7<br>  BEGIN<br>    SET @open = 0<br>    SET @process = 0<br>  END<br>ELSE<br>  BEGIN<br>    SET @open =1<br>    SET @process = 1<br>  END<br>--Output contents of @open<br>SELECT @open as OpenForBusiness</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R232" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">233</div></th><td class="s5" dir="ltr">Looping statements</td><td class="s5" dir="ltr">Looping is the ability to repeat blocks of code. Looping is executed using the WHILE statement.</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--Declare variable<br>Declare @counter INT<br>--Populate variable<br>SET @counter=1<br>--Execute while equal or less then 10<br>WHILE @counter &lt;= 10<br>--Begin define block of code to excute<br>BEGIN<br>	--Output counter<br>	PRINT @counter<br>	-- Add 1 to counter every loop<br>	SET @counter= @counter+1<br>--End block of code to execute<br>END</td><td class="s5" dir="ltr">1 <br>2 <br>3 <br>4 <br>5 <br>6 <br>7 <br>8 <br>9 <br>10 <br>Total execution time: 00:00:00.003</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R233" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">234</div></th><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R234" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">235</div></th><td class="s2" dir="ltr">Cursors</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R235" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">236</div></th><td class="s4" dir="ltr">Objective</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Notes</td><td class="s4" dir="ltr">Results</td></tr><tr style="height: 20px"><th id="0R236" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">237</div></th><td class="s5" dir="ltr">DECLARE CURSOR</td><td class="s5" dir="ltr">Cursors are created using the DECLARE statement. DECLARE names the cursor and takes a SELECT statement, complete with WHERE and other clauses if needed</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">DECLARE CustCursor CURSOR<br>FOR<br>SELECT * FROM Customers<br>WHERE cust_email IS NULL</td><td class="s5" dir="ltr"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R237" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">238</div></th><td class="s5" dir="ltr">OPEN CURSOR</td><td class="s5" dir="ltr">Cursors are opened using the OPEN CURSOR statement</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">OPEN CURSOR CustCursor</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R238" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">239</div></th><td class="s5" dir="ltr">FETCH</td><td class="s5" dir="ltr">Cursor data can be accessed using the FETCH statement. FETCH specifies the rows to be retrieved, where they are to be retrieved from and where they are to be stored</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">DECLARE @cust_id CHAR(10),<br>  @cust_name CHAR(50),<br>  @cust_address CHAR(50),<br>  @cust_city CHAR(50),<br>  @cust_state CHAR(5),<br>  @cust_zip CHAR(10),<br>  @cust_country CHAR(50),<br>  @cust_contact CHAR(50),<br>  @cust_email CHAR(255)<br>OPEN CustCursor<br>FETCH NEXT FROM CustCursor<br>  INTO @cust_id, @cust_name, @cust_address,<br>       @cust_city, @cust_state, @cust_zip,<br>       @cust_country, @cust_contact,<br>       @cust_email<br>  ...<br>WHILE @@FETCH_STATUS = 0<br>BEGIN<br>FETCH NEXT FROM CustCursor<br>       INTO @cust_id, @cust_name,<br>            @cust_address,@cust_city, <br>            @cust_state, @cust_zip,<br>            @cust_country, @cust_contact,<br>            @cust_email<br>END<br>CLOSE CustCursor</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R239" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">240</div></th><td class="s5" dir="ltr">CLOSE CURSOR</td><td class="s5" dir="ltr">The CLOSE statement is used to close cursors</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CLOSE CustCursor<br>DEALLOCATE CURSOR CustCursor</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R240" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">241</div></th><td class="s5" dir="ltr">Cursor Example</td><td class="s5" dir="ltr">In this example, we place a PRINT statement to print value in @order_num variable. All code must be executed at the same time. This example stores all values in the specified column in the variable @order_num (as specified in the SELECT statement) and then prints these values when executed</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">Declare local variable<br>DECLARE @order_num INT;<br>--This code defines a cursor named orders_cursor with a select statement<br>DECLARE orders_cursor CURSOR<br>FOR<br>--Select statement used to retrieve data<br>SELECT order_num<br>FROM orders <br>ORDER BY order_num;<br><br>--Open cursor (retrieve data)<br>OPEN orders_cursor<br><br>--Perform first fetch (get first row)<br>FETCH NEXT FROM orders_cursor <br>      INTO @order_num<br><br>--Check @@FETCH_STATUS to see if there are any more rows to fetch<br>      WHILE @@FETCH_STATUS = 0<br>           BEGIN<br>               --Print order numbers to screen     <br>              Print @order_num<br><br>	         --Get next row only if previous fetch succeeds<br>	         FETCH NEXT FROM orders_cursor<br>		       INTO @order_num<br>           END<br>--Close cursor<br>CLOSE orders_cursor<br><br>--Remove cursor<br>DEALLOCATE orders_cursor;</td><td class="s5" dir="ltr">20005<br>20006<br>20007<br>20008<br>20009<br>20100</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R241" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">242</div></th><td class="s5" dir="ltr">Cursor Example</td><td class="s5" dir="ltr">This example is like the previous one except it concatenates printed data and stores multiple variables</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">USE AdventureWorks<br>GO<br>-- Declare the variables to store the values returned by FETCH.<br>DECLARE @LastName varchar(50), @FirstName varchar(50)<br>DECLARE contact_cursor CURSOR FOR<br>SELECT LastName, FirstName <br>FROM Contact<br>WHERE LastName LIKE &#39;B%&#39;<br>ORDER BY LastName, FirstName<br><br>OPEN contact_cursor<br>-- Perform the first fetch and store the values in variables.<br>-- Note: The variables are in the same order as the columns<br>-- in the SELECT statement. <br>FETCH NEXT FROM contact_cursor<br>INTO @LastName, @FirstName<br><br>-- Check @@FETCH_STATUS to see if there are any more rows to fetch.<br>WHILE @@FETCH_STATUS = 0<br>BEGIN<br><br>   -- Concatenate and display the current values in the variables.<br>   PRINT &#39;Contact Name: &#39; + @FirstName + &#39; &#39; +  @LastName<br><br>   -- This is executed as long as the previous fetch succeeds.<br>   FETCH NEXT FROM contact_cursor<br>   INTO @LastName, @FirstName<br>END</td><td class="s5" dir="ltr">Contact Name: Phillip Bacalzo<br>Contact Name: Dan Bacon<br>Contact Name: Dan Bacon<br>Contact Name: Abigail Bailey<br>Contact Name: Adrian Bailey</td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R242" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">243</div></th><td class="s5" dir="ltr">Cursor Example</td><td class="s5" dir="ltr"></td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">-- Name: ordertotal<br>-- Parameters:        @order_num                = order number<br>--                        @taxable                = 0 if not taxable, 1 if taxable<br>--                        @order_total        = order total variable<br><br>ALTER PROCEDURE usp_ordertotal<br>        @order_num INT,<br>        @taxable BIT,<br>        @order_total Money OUTPUT<br>AS<br>BEGIN<br>        --Declare variable for total<br>        DECLARE @total Money;<br>        --Declare tax percentage<br>        DECLARE @taxrate INT;<br>        --Set tax rate <br>        SET @taxrate = 6;<br><br>        --Get the order total<br>        SELECT @total = SUM(item_price*quantity)<br>        FROM orderitems<br>        WHERE order_num = @order_num<br>        <br>        --Is this taxable?<br>        If @taxable = 1<br>           --Yes, so add taxrate to the total<br>                SET @total=@total+(@total/100*@taxrate);<br>        <br>        -- And finally, save to OUTPUT variable<br>        SELECT @order_total= @total;<br>END;</td><td class="s5" dir="ltr"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R243" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">244</div></th><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R244" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">245</div></th><td class="s2" dir="ltr">Constraints</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R245" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">246</div></th><td class="s4" dir="ltr">Objective</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Notes</td><td class="s4" dir="ltr">Results</td></tr><tr style="height: 20px"><th id="0R246" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">247</div></th><td class="s5" dir="ltr">PRIMARY KEY</td><td class="s5" dir="ltr">Creates table and defines a primary key</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE TABLE Vendors<br>(  @vend_id CHAR(10) NOT NULL <span style="color:#0000ff;">PRIMARY KEY</span>,<br>   @vend_name CHAR(50) NOT NULL,<br>   @vend_address CHAR(50) NULL,<br>   @vend_city CHAR(50) NULL,<br>   @vend_state CHAR(5) NULL,<br>   @vend_zip CHAR(10) NULL,<br>   @vend_country CHAR(50) NULL<br>);</td><td class="s5" dir="ltr"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R247" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">248</div></th><td class="s5" dir="ltr">ADD CONSTRAINT PRIMARY KEY</td><td class="s5" dir="ltr">Alters table and designates a column as the primary key; this syntax can be used in CREATE TABLE and ALTER TABLE statements</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">ALTER TABLE Vendors<br><span style="color:#0000ff;">ADD CONSTRAINT PRIMARY KEY</span> <span style="color:#ff00ff;">(vend_id)</span>;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R248" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">249</div></th><td class="s5" dir="ltr">REFERENCES Table(foreign_key)</td><td class="s5" dir="ltr">Creates table and defines a foreign key</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE TABLE Orders<br>(  order_num INTEGER NOT NULL PRIMARY KEY,<br>   order_date DATETIME NOT NULL,<br>   <span style="color:#ff00ff;">cust_id CHAR(10) NOT NULL</span> <span style="color:#0000ff;">REFERENCES</span><span style="color:#ff00ff;"> Customers(cust_id)</span><br>);</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R249" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">250</div></th><td class="s5" dir="ltr">ADD CONSTRAINT FOREIGN KEY</td><td class="s5" dir="ltr">Alters table and designates a column as the foreign key</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">ALTER TABLE Orders<br>ADD CONSTRAINT<br><span style="color:#ff00ff;">FOREIGN KEY (cust_id) </span><span style="color:#0000ff;">REFERENCES</span><span style="color:#ff00ff;"> Customers (cust_id)</span></td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R250" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">251</div></th><td class="s5" dir="ltr">CHECK [constraint]</td><td class="s5" dir="ltr">Checks every row to ensure that the column quantity &gt; 0 using a CHECK [constraint] statement</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE TABLE OrderItems<br>(  order_num INTEGER NOT NULL,<br>   order_item INTEGER NOT NULL,<br>   prod_id CHAR(10) NOT NULL,<br>   quantity INTEGER NOT NULL <span style="color:#ff00ff;">CHECK (quantity&gt;0)</span>,<br>   item_price MONEY NULL<br>);</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R251" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">252</div></th><td class="s5" dir="ltr">ADD CONSTRAINT CHECK</td><td class="s5" dir="ltr">Checks every row in column &#39;gender&#39; to validate that the value is LIKE &#39;[MF]&#39;</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">ADD CONSTRAINT CHECK (gender LIKE &#39;[MF]&#39;)</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R252" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">253</div></th><td class="s5" dir="ltr">CREATE TRIGGER</td><td class="s5" dir="ltr">Creates a trigger on the Customers table by setting cust_state to all uppercase on all INSERT and UPDATE operations</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE TRIGGER customer_state<br>ON Customers<br>FOR INSERT, UPDATE<br>AS<br>UPDATE Customers<br>SET cust_state = Upper(cust_state)<br>WHERE Customers.cust_id = inserted.cust_id</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R253" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">254</div></th><td class="s5" dir="ltr">CREATE TRIGGER: &#39;product added&#39;</td><td class="s5" dir="ltr">Simple trigger that displays &#39;product added&#39; when a new row is inserted into the Products table</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE TRIGGER trg_newproduct ON Products<br>FOR INSERT<br>AS<br>SELECT &#39;Product added&#39;;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R254" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">255</div></th><td class="s5" dir="ltr">DISABLE TRIGGER</td><td class="s5" dir="ltr">Disables a trigger</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--This code disables a trigger<br>DISABLE TRIGGER trg_newproduct on products</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R255" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">256</div></th><td class="s5" dir="ltr">ENABLE TRIGGER</td><td class="s5" dir="ltr">Enables a trigger</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--This code enables a trigger<br>ENABLE TRIGGER trg_newproduct on products</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R256" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">257</div></th><td class="s5" dir="ltr">DROP TRIGGER</td><td class="s5" dir="ltr">Drops a trigger</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">--This code drops a trigger<br>DROP TRIGGER trg_newproduct;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R257" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">258</div></th><td class="s5" dir="ltr">CREATE TABLE FOR INSERT TRIGGER</td><td class="s5" dir="ltr">Run this script before creating a trigger based on the tables referenced by the script</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">DROP TRIGGER IF EXISTS trg_neworder2;<br>DROP TABLE IF EXISTS orders2;<br><br>--Make copy of Orders2<br>SELECT * INTO Orders2 from Orders;<br><br>--Create a new column (temporary)<br>ALTER TABLE orders2<br>DROP COLUMN order_num_tmp;<br><br>ALTER TABLE Orders2<br>ADD order_num_tmp Int Identity(1, 1);<br><br>ALTER TABLE<br>Orders2 DROP Column order_num;<br><br>Exec sp_rename &#39;Orders2.order_num_tmp&#39;, &#39;order_num&#39;, &#39;Column&#39;;<br>GO</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R258" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">259</div></th><td class="s5" dir="ltr">CREATE TRIGGER FOR INSERT</td><td class="s5" dir="ltr">Insert triggers are executed after an INSERT statement is executed. You can refer to virtual table named INSERTED inside the trigger code. <br><br>In the following example, we will return the value of the identity column in the orders table. Identity columns have a value automatically assigned. Here we create a trigger called trg_neworder on the orders table. When a new record is successfully inserted the trigger grabs the value from the identity column and stored it in the new variable we declared called @@IDENTITY. The select statement retrieves the value and displays it on the screen.</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">Create TRIGGER trg_neworder2 on orders2<br>FOR INSERT<br>AS<br>SELECT @@IDENTITY AS order_num</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R259" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">260</div></th><td class="s5" dir="ltr">[test the trigger]</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">-- test the trigger:<br>SET IDENTITY_INSERT orders2 ON;<br>INSERT INTO orders2<br>           (<br>           order_num,<br>           order_date<br>           ,cust_id)<br>     VALUES<br>           (10010,<br>                        &#39;2/21/2008&#39;,<br>            1000000001)</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R260" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">261</div></th><td class="s5" dir="ltr">CREATE TABLE FOR DELETED ENTRIES</td><td class="s5" dir="ltr">Creates a table OrdersArchive so that the trigger below, when fired, inserts deleted entries from the Orders table into the OrdersArchive table</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE TABLE OrdersArchive<br>(<br>  ordersarchive_ID int NOT NULL IDENTITY(1,1) Primary Key,<br>  order_num  INT,<br>  order_date DATETIME NOT NULL ,<br>  cust_id    INT      NOT NULL<br>);</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R261" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">262</div></th><td class="s5" dir="ltr">CREATE TRIGGER AFTER DELETE THEN INSERT</td><td class="s5" dir="ltr">Trigger that is triggered when a row is deleted from the Orders table; these rows are then inserted into the OrdersArchive table</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">Create TRIGGER trg_deleteorderarchive2 on orders<br>AFTER DELETE<br>AS<br>BEGIN<br>        INSERT INTO OrdersArchive<br>                        (<br>                        order_num,<br>                        order_date,<br>                        cust_id<br>                        )<br>        Select <br>                        order_num,<br>                        order_date,<br>                        cust_id<br>        FROM DELETED<br>END</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R262" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">263</div></th><td class="s5" dir="ltr">[test the trigger]</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">-- Allow manual inserts’ to identity <br>SET IDENTITY_INSERT orders2 ON;<br>INSERT INTO orders2<br>           (<br>           order_num,<br>           order_date<br>           ,cust_id)<br>     VALUES<br>           (10010,<br>            &#39;2/21/2008&#39;,<br>            1000000001)</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R263" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">264</div></th><td class="s5" dir="ltr">CREATE TRIGGER (UPDATE)</td><td class="s5" dir="ltr">Trigger that is triggered when Vendors table is updated through an INSERT or UPDATE statement; changes the value of the country column to uppercase</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE TRIGGER trg_vendors ON vendors<br>AFTER INSERT, UPDATE<br>AS<br>BEGIN<br>        UPDATE vendors<br>                SET vend_country=UPPER(vend_country)<br>        WHERE vend_id IN (SELECT vend_id FROM INSERTED);<br>END</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R264" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">265</div></th><td class="s5" dir="ltr">[test the trigger]</td><td class="s5" dir="ltr">--</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">-- test the trigger<br>UPDATE vendors<br>   SET vend_name = &#39;AnvilsRUs&#39;     <br> WHERE vend_id = &#39;FNG01&#39;</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R265" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">266</div></th><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6" dir="ltr"></td><td class="s6"></td><td class="s6"></td></tr><tr style="height: 20px"><th id="0R266" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">267</div></th><td class="s2" dir="ltr">Indexes</td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s2"></td><td class="s3"></td></tr><tr style="height: 20px"><th id="0R267" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">268</div></th><td class="s4" dir="ltr">Objective</td><td class="s4">Description</td><td class="s4">Syntax</td><td class="s4">Example</td><td class="s4" dir="ltr">Notes</td><td class="s4" dir="ltr">Results</td></tr><tr style="height: 20px"><th id="0R268" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">269</div></th><td class="s5" dir="ltr">CREATE INDEX</td><td class="s5" dir="ltr">Indexes are created with the CREATE INDEX statement; ON is used to specify the table being indexed (Products) and the columns to include in the index (prod_name)</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE INDEX prod_name_index<br>ON Products (prod_name);</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R269" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">270</div></th><td class="s5" dir="ltr">Creating a simple non-clustered index</td><td class="s5" dir="ltr">Creates a nonclustered index on the cust_id column of the Orders table in the SQLClass database</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE INDEX IX_Orders_cust_id <br>    ON Orders (cust_id);</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R270" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">271</div></th><td class="s5" dir="ltr">Creating a simple nonclustered composite index</td><td class="s5" dir="ltr">Creates a nonclustered composite index on the prod_name and prod_price columns of the Products table in the SQLClass database</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE INDEX IX_Products_prodname_prodprice <br>    ON Products (prod_name, prod_price);</td><td class="s5"></td><td class="s5"></td></tr><tr style="height: 20px"><th id="0R271" style="height: 20px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 20px">272</div></th><td class="s5" dir="ltr">Creating a simple unique nonclustered index</td><td class="s5" dir="ltr">Creates a nonclustered composite index on the vend_name column of the Vendors table in the SQLClass database</td><td class="s5" dir="ltr">see example &gt;&gt;</td><td class="s5" dir="ltr">CREATE UNIQUE INDEX AK_vendorName <br>    ON Vendors (vend_name);</td><td class="s5"></td><td class="s5"></td></tr></tbody></table></div>
